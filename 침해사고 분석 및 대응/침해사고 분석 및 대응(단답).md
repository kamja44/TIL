1. [IDS(Intrusion Detection System)](#ids-intrusion-detection-system-침입탐지시스템)<br>
   &nbsp;&nbsp;.1-1. [오용 탐지(misuse detection)](#오용-탐지misuse-detection)<br>
   &nbsp;&nbsp;.1-2. [이상 탐지(anomaly detection)](#이상-탐지anomaly-detection)<br>
   &nbsp;&nbsp;.1-3. [호스트 기반 IDS(HIDS : Host based IDS)](#오용-탐지misuse-detection)<br>
   &nbsp;&nbsp;.1-4. [네트워크 기반 IDS(NIDS : Network based IDS)](#네트워크-기반-idsnids--network-based-ids)<br>
2. [IPS(Intrusion Prevention System)](#ips-intrusion-prevention-system-침입-방지-시스템)<br>
3. [Firewall(방화벽)](#firewall방화벽)<br>
4. [VPN(가상사설망)](#vpn가상사설망)<br>
5. [Snort(스노트)](#snort스노트)<br>
6. [Suricata(수리카타)](#suricata수리카타)<br>

# IDS(: Intrusion Detection System 침입탐지시스템)

- 사전에 등록한 알려진 공격 패턴, 임계치 등을 기반으로 공격 행위를 탐지하는 보안장비이다.
- 패킷의 내용이나 시스템 로그 등을 분석하여 악의적인 공격 여부를 판단한다.
- 침입 탐지 방식에 따라 `오용 탐지 방식과 이상 탐지 방식`으로 나눌 수 있다.
- 탐지할 데이터 수집원에 따라 `호스트 기반 IDS과 네트워크 기반 IDS`으로 구분할 수 있다.
- 탐지 장비들의 공격 행위 탐지 결과는 정탐(true positive)뿐만 아니라 오탐 및 미탐이 발생할 수 있다.
  - 탐지 결과의 심각성 관점에서 볼 때 오탐보다 미탐이 더 심각한 상황이므로, 미탐을 줄이는 것이 매우 중요하다.
    - 정탐(true positive) -> 공격 행위를 정확히 탐지
    - 오탐(false positive) -> 공격 행위가 아닌 것을 공격 행위로 탐지
    - 미탐(false negative) -> 공격 행위를 탐지하지 못함

## 오용 탐지(misuse detection)

- 사전에 등록한 알려진 공격 패턴을 기반으로 공격 행위를 탐지하는 방식이다.
- 지식 기반 탐지 또는 시그니처 기반 탐지라고도 한다.
- 알려진 공격 패턴을 기반으로 탐지하기에, 지속적인 공격 패턴 갱신이 필요하다.
- 상대적으로 오탐률이 낮지만, 새로운 공격에 대해선 탐지할 수 없다. 즉, 미탐률이 높다.

## 이상 탐지(anomaly detection)

- 정량적이고 평균적인 상태를 기준으로, 이를 벗어난 행위를 공격 행위로 탐지하는 방식이다.
- 행위 기반 탐지 또는 통계 기반 탐지라고도 한다.
- 정량적이고 통계적인 분석을 통해 측정한 정상 행위와 비정상 행위를 구분할 수 있는 임게치를 기반으로 탐지하는 방식이다.
- 임계치 설정을 위한 학습 과정에 많은 시간과 데이터가 필요하다.
- 알려지지 않은 새로운 공격도 탐지가 가능하므로 미탐률이 낮지만, 정상 행위와 비정상 행위를 구분하는 임계치 설정이 어려워 오탐률이 높다.

## 호스트 기반 IDS(HIDS : Host based IDS)

- 호스트에 설치되어 호스트 정보를 수집하여 탐지 활동을 수행하는 IDS이다.
- 호스트 내부에 설치되어 호스트 정보를 수집하여, 관리자 권한을 획득하거나 시스템을 변조하는 등의 내부 공격을 탐지한다.
- 대표적인 `오픈소스 HIDS로 트립와이어(tripwire)가 있다.`
  - 호스트 파일시스템의 파일 무결성을 점검하는 도구로 사용된다.
- HIDS는 단일 호스트 기반 IDS와 다중 호스트 기반 IDS로 세분화할 수 있다.
  - 단일 호스트 기반 IDS(Single Host based IDS)
    - 단일 호스트로부터 정보를 수집하여 탐지하는 방식이다.
    - 호스트에서 실행되는 인텔리전트한 특정 프로그램이 OS를 계속해서 감시, 모니터링하고 그 결과를 로그파일에 저장하고 이벤트를 발생시키며 부정한 행위가 탐지되었을 경우 관리자에게 알려준다.
  - 다중 호스트 기반 IDS(Multi Host based IDS)
    - 여러 호스트로부터 정보를 수집하여 탐지하는 방식이다.
    - 각각의 단일 호스트에 인텔리전트한 특정 프로그램이 클라이언트의 기능으로 실행되고 특정 서버는 자료를 모으는 서버 역할을 하여 다른 클라이언트 시스템에 저장된 로그파일을 취합하여 분석하고 통계를 작성하여 보고하도록 구성된 시스템이다.

## 네트워크 기반 IDS(NIDS : Network based IDS)

- 네트워크 트래픽을 수집하여 탐지 활동을 수행하는 IDS를 말한다.
- 네트워크 특정 지점에 설치되어 네트워크 트래픽 정보를 수집하여 취약점 스캐닝, 네트워크 공격 등을 탐지한다.
- `대표적인 오픈소스 NIDS로 스노트(snort)와 스노트의 단점을 보완한 수리카타(Suricata)가 있다.`
  - 수리카타(Suricata)
    - 기존 스노트의 단일 스레드 방식을 개선하여 대용량 트래픽을 실시간으로 처리할 수 있도록 멀티 코어/멀티 스레드를 지원하며, 기존 스노트와도 완벼하게 호환된다.
- NIDS는 주로 미러링 모드(mirroring mode)로 설치한다.
  - 실제 트래픽에 대한 실시간 차단이 아닌 탐지 목적의 장비이기 때문

# IPS(: Intrusion Prevention System 침입 방지 시스템)

- IDS(침입탐지시스템)의 탐지 기능과 방화벽의 차단 기능을 결합하여, 비정상적인트래픽에 대한 실시간 방지를 수행한다.
- 침입방지시스템(IPS)은 사전에 등록한 알려진 공격 패턴, 임계치 등을 기반으로 `공격 행위를 탐지하고 실시간 차단까지 수행하는 보안장비이다.`
- 공격 행위 탐지 후 통보라는 수동적인 방어 개념의 침입탐지시스템(IDS)와 달리, 공격 행위가 탐지되면 이를 능동적으로 차단하는 보안 장비이다.
- IPS는 주로 인라인 모드(inline mode)로 설치한다.
  - 실제 트래픽에 대한 탐지뿐만 아니라 실시간 차단 목적의 장비이기 때문

# Firewall(방화벽)

- 프로토콜, IP 주소, Port 번호 등을 이용하여 정해진 정책에 따라 패킷 필터링을 수행하는 차단 장비이다.
- 네트워크 구간에 전송되는 패킷들을 정해진 규칙에 따라 차단하거나 통과시켜 공격자로부터 내부 자산을 보호하는 시스템이다.

# VPN(가상사설망)

- 인터넷과 같은 공중망을 이용하여, 마치 사설망을 사용하듯 네트워크를 안전하게 연결하기 위한 통신 터널을 만들어 데이터를 안전하게 전송하는 시스템이다.

# Snort(스노트)

- Open Source 네트워크 침입탐지시스템(NIDS)이다.
- Network에서 실시간 Traffic 분석과 Packet logging을 수행하는 NIDS다.
- 프로토콜 분석, 콘텐츠 검색/비교 작업을 할 수 있으며, 다양한 공격과 스캔을 탐지할 수 있다.
- 패킷 로거, 스니퍼, 네트워크 침입 탐지 모드로 동작할 수 있으며, 그 중 스니퍼 모드는 단순히 네트워크에서 패킷을 읽어 콘솔에 출력한다.
- snort는 프로토콜 분석, 컨텐츠 검색, 취약점 악용 시도, 포트 스캔, 버퍼 오버플로우, OS fingerprinting, 웜 등의 다양한 공격을 탐지한다.

## Snort Rule

```
10번째 바이트부터 2바이트 범위에 FFFF 바이너리 패턴이 있는지 검사하기 위한 snort 룰

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"TEST"; content:|FFFF|; offset:9; depth:2; sid:1000001;)
```

```
패킷의 내용을 검사하여, "/administrator"란 문자열이 포함된 경우 "Web Scan Detected"란 메시지로 로깅을 하기 위한 snort 룰

alert tcp any any -> 192.168.159.131 80 (content:"/administrator"; msg:"Web Scan Detected";)
```

|  Rule   | 설명                                                                                                                             |
| :-----: | :------------------------------------------------------------------------------------------------------------------------------- |
| content | 페이로드에서 검사할 문자열을 지정한다.<br>문자열은 text 형식일 수도 있고 binary 형식일 수 있으며, 두 개가 복합된 형식일 수 있다. |
| offset  | 페이로드에서 content 패턴을 검사할 시작 위치로 페이로드의 첫 번째 바이트 위치가 0부터 시작한다.                                  |
|  depth  | offset부터 몇 바이트까지 검사할 것인지를 지정한다.                                                                               |
|   msg   | 메시지 로깅 시 이벤트 명을 지정하는 옵션이다.                                                                                    |

# Suricata(수리카타)

- 기존 snort의 단일 스레드 방식에서 벗어나 대용량 트래픽을 실시간으로 처리할 수 있도록 멀티 코어/멀티 스레드를 지원하며 기존 snort도 완벽하게 호환된다.
- Suricata 특징
  - 멀티코어 및 멀티 스레드 지원
  - snort 룰 완벽 호환 및 대부분 기능을 지원
  - 하드웨어 벤더의 개발 지원으로 하드웨어 가속 지원
  - 스크립트 언어(Lua) 지원
