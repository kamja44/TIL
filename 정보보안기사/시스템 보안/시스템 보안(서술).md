1. [utmp와 wtmp 차이점](#utmp와-wtmp-차이점)<br>
2. [chown](#chown)<br>
3. [chgrp](#chgrp)<br>
4. [MAC Time](#mac-time)<br>
5. [PAM 모듈 설정의 의미](#pampluggable-authentication-module-모듈-설정의-의미)<br>
6. [버퍼 오버플로우 예방책](#버퍼-오버플로우-예방책)<br>
7. [touch](#touch-명령어)<br>
8. [ls](#ls-명령어)<br>
   &nbsp;&nbsp;8-1. [ls 명령어 옵션](#ls-명령어-옵션)<br>
9. [Race Condition](#race-condition)<br>
   &nbsp;&nbsp;9-1. [Race Condition 공격 대응 방안](#race-condition-공격-대응-방안)<br>
10. [OS별 패스워드 정책 설정 파일](#os별-패스워드-정책-설정-파일)<br>
    &nbsp;&nbsp;10-1. [LINUX의 login.defs 파일의 주요 권장 설정](#linux의-logindefs-파일의-주요-권장-설정)<br>
11. [root 계정의 PATH 설정](#root-계정의-path-설정)<br>
12. [윈도우 암호/패스워드 보안 정책](#윈도우-암호패스워드-보안-정책)<br>

# utmp와 wtmp 차이점

1. utmp는 현재 로그인한 사용자 정보를 가지고 있고 wtmp는 지금까지 로그인한 사용자의 로그인/로그아웃 히스토리 정보를 갖고 있다.
2. wtmp는 시스템 부팅(booting) 히스토리 정보를 갖고 있다.
3. wtmp는 시스템 셧다운(shutdown) 히스토리 정보를 갖고 있다.

# chown

- chown [소유자] [파일명]
- 해당 파일 소유자를 변경한다. 단, root만 실행할 수 있다.

# chgrp

- chgrp [소유그룹] [파일명]
- 해당 파일에 대한 소유그룹을 변경한다. 단, root만 실행할 수 있다.

# MAC Time

- 리눅스 시스템의 파일시스템의 타임라인에서 제공하는 시간 속성들이다.

1. mtimt(last Modify Time)

- 파일의 내용이 마지막으로 수정된 시간

2. atime(last Access Time)

- 파일에 마지막으로 접근한 시간

3. ctime(last Change Time)

- 파일의 속성 정보(소유자, 접근 권한 등)가 마지막으로 변경된 시간

# PAM(Pluggable Authentication Module) 모듈 설정의 의미

```
#cat /etc/pam.d/system-auth
auth required /lib/security/pam_tally.so deny=5 unlock_time=120 no_magic_root
account required /lib/security/pam_tally.so no_magic_root reset
```

deny=5

- 5회 입력 실패 시 패스워드 잠금
  unlock_time = 120
- 계정이 잠김 후 마지막 계정 실패 시간으로부터 120초가 지나면 계정 잠금 해제
  no_magic_root
- root 계정은 패스워드 잠금 설정을 적용하지 않는다.
  reset
- 접속 시도 성공 시 실패 횟수 초기화

# 버퍼 오버플로우 예방책

1. 스택가드

- 메모리상에서 `프로그램의 복귀주소와 변수 사이에 특정 값을 저장해 두었다가 그 값이 변경되었을 경우 오버플로우로 가정`하여 프로그램의 실행을 중단한다.
- `카나리 단어 기법`이라고도 한다.

2. 스택쉴드

- 함수 시작 시 `리턴 주소를 Global RET라는 특수 스택에 저장해 두었다가 함수 종료 시 저장된 값과 스택의 RET 값을 비교하여 다를 경우 프로그램을 종료`한다.

3. ASLR(Address Space Layout Randomization)

- 메모리 공격을 방어하기 위해 주소 공간 배치를 난수화하는 기법이다.
- 실행 시마다 메모리 주소를 변경시켜 악성코드에 의한 특정주소 호출을 방지한다.

```
echo 2> /proc/sys/kernel/randomize_va_space
```

- 리눅스 커널에서 ASLR을 설정하는 코드이다.
  - randomize_va_space 커널 파라미터를 0으로 설정하면, 사용하지 않는다는 의미이고, 1로 설정하면 힙 이외는 모두 랜덤하게 설정한다는 의미이고, 2로 설정하면 모두 랜덤하게 설정한다는 의미이다.

4. 입력값 검증 or 버퍼 오버플로우에 취약하지 않은 함수 사용

- 프로그램 개발 시 버퍼 오버플로우에 취약하지 않은 함수를 사용하거나 입력값에 대한 적절한 크기 검증을 통해 오버플로우가 발생하지 않도록 한다.

# touch 명령어

- 파일의 생성과 파일의 날짜, 시간을 변경하는 명령어이다.
  - 옵션 없이 사용할 경우 현재시간으로 변경된다.
- 파일이 존재하지 않을 경우 크기가 0인 파일을 생성한다.
  `touch [파일이름]` => 크기가 0인 파일을 생성

`touch [옵션] [파일이름]`

- -m
  - 파일의 생성, 수정 시간을 서버 시간으로 변경할 경우 사용되는 옵션이다.
- -t
  - 파일의 생성, 수정 시간을 사용자가 원하는 시간으로 변경할 경우 사용되는 옵션이다.

# ls 명령어

- 디렉토리에 있는 내용(디렉토리, 파일 등)을 확인한다.

## ls 명령어 옵션

| 옵션 | 내용                                                                                            |
| :--: | :---------------------------------------------------------------------------------------------- |
|  -l  | - 자세한 내용을 출력한다.<br>- 권한, 포함된 파일 수, 소유자, 그룹, 파일크기, 수정일자, 파일이름 |
|  -a  | - 경로 안의 모든 파일을 나열한다.(숨김파일도 포함)                                              |
|  -R  | - 위치한 디렉토리 하부 디렉토리의 파일까지 모두 출력한다.                                       |
|  -h  | - 파일크기를 해석하기 편하게 출력한다.                                                          |
|  -r  | - 출력 결과를 내림차순으로 정렬한다.                                                            |
|  -t  | - 출력 결과를 파일이 수정된 시간을 기준으로 정렬한다.                                           |

# Race Condition

- Race Condition은 둘 이상의 프로세스나 스레드가 공유 자원에 동시에 접근할 때 순서에 따라 결과가 발생하는 상황을 말한다.
- 실행중인 프로세스가 임시파일을 만드는 경우 악의적인 프로그램을 통해 그 프로세스의 실해중에 끼어들어 임시파일을 목적파일로 연결(심볼릭 링크) 하여 악의적인 행위를 할 수 있다.
- 만일, 프로세스가 SUID 설정이 되어 root 권한으로 실행된다면 권한이 상승되는 문제가 발생할 수 있다.

## Race Condition 공격 대응 방안

1. 가능하면 임시파일을 생성하지 않는다.

- 임시파일을 만드는 것은 Race Condition의 주요 원인이다.

2. 파일 생성 시 이미 동일한 파일이 존재하는 경우 파일 생성 또는 쓰기를 금지한다.
3. 사용하고자 하는 파일에 링크가 걸려있으면 실행을 중지한다.
4. umask를 최하 022 정도로 유지하여 임시로 생성한 파일이 공격자에 의해 악의적으로 삭제되지 않도록 한다.

# OS별 패스워드 정책 설정 파일

|       OS       | 정책 설정 파일        |
| :------------: | :-------------------- |
| SunOS(Solaris) | /etc/default/passwd   |
|     LINUX      | /etc/login.defs       |
|      AIX       | /etc/security/user    |
|     HP-UX      | /etc/default/security |

## LINUX의 login.defs 파일의 주요 권장 설정

PASS_MIN_LEN 8

- 패스워드 최소 길이를 8자 이상으로 설정한다.
  PASS_MAX_DAYS 90
- 패스워드 최대 사용기간을 90일로 설정한다.
  PASS_MIN_DAYS 1
- 패스워드 최소 사용기간을 1일로 설정한다.

# root 계정의 PATH 설정

취약점

- PATH 환경변수에 `.`(현재 디렉터리 지정) 설정이 맨 앞 또는 중간에 있으면, root 계정으로 접속한 관리자가 현재 디렉터리에 불법적으로 위치한 실행파일에 의해 의도하지 않은 명령이 실행될 수 있다.
  조치방안
- PATH 환경변수의 `.`(현재 디렉터리 지정) 설정을 맨 뒤로 이동시키거나 불필요한 경우 삭제한다.

# 윈도우 암호/패스워드 보안 정책

|                   정책                    | 설명                                                                                                                                                                    |
| :---------------------------------------: | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|           패스워드 복잡성 설명            | - 패스워드 설정 시 영문자(대소문자), 숫자, 특수문자를 모두 포함하여 보안상 안전한 패스워드를 설정한다.<br>- 권장 설정 : 사용                                            |
|              최근 암호 기억               | - 사용자가 최근에 사용했던 패스워드를 동일하게 사용할 수 없도록 설정하는 정책이다.<br>- 이전 암호 2개에 대해서는 동일하게 사용할 수 없다.<br>- 권장 설정 : 12개 이상    |
|            최대 암호 사용시간             | - 패스워드 사용 만료 기간으로 최대 42일까지 패스워드 사용이 가능하고 그 이후에는 변경해야 한다.<br>- 권장 설정 : 90일 이하                                              |
|              최소 암호 길이               | - 패스워드 최소 길이를 8자 이상으로 설정한다.<br>- 권장 설정 : 8자 이상                                                                                                 |
|            최소 암호 사용기간             | - 새롭게 설정한 패스워드를 2일 동안 변경하지 못하게 한다.<br>- 최소 암호 기간을 설정하지 않으면 '최근 암호 기억'을 무력화할 수 있기 때문이다.<br>- 권장 설정 : 1일 이상 |
| 해독 가능한 암호화를 사용하여 암호를 저장 | - 해독 불가능한 암호화 방식을 사용한다.<br>- 권장 설정 : 사용안함                                                                                                       |
