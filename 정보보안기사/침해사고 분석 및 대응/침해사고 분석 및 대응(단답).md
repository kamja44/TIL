1. [IDS(Intrusion Detection System)](#ids-intrusion-detection-system-침입탐지시스템)<br>
   &nbsp;&nbsp;.1-1. [오용 탐지(misuse detection)](#오용-탐지misuse-detection)<br>
   &nbsp;&nbsp;.1-2. [이상 탐지(anomaly detection)](#이상-탐지anomaly-detection)<br>
   &nbsp;&nbsp;.1-3. [호스트 기반 IDS(HIDS : Host based IDS)](#오용-탐지misuse-detection)<br>
   &nbsp;&nbsp;.1-4. [네트워크 기반 IDS(NIDS : Network based IDS)](#네트워크-기반-idsnids--network-based-ids)<br>
2. [IPS(Intrusion Prevention System)](#ips-intrusion-prevention-system-침입-방지-시스템)<br>
3. [Firewall(방화벽)](#firewall방화벽)<br>
   &nbsp;&nbsp;3-1. [Stateful Inspection 방화벽](#stateful-inspection-방화벽)<br>
   &nbsp;&nbsp;3-2. [방화벽의 Stateful Inspection 기능](#방화벽의-stateful-inspection-기능)<br>
   &nbsp;&nbsp;3-3. [Bastion Host(베스천 호스트)](#bastion-host배스천-호스트)<br>
   &nbsp;&nbsp;3-4. [스크리닝 라우터(Screening Router) 방식](#스크리닝-라우터screening-router-방식)<br>
   &nbsp;&nbsp;3-5. [듀얼 홈드 게이트웨이 방식(Dual-Homed Gateway) 방식](#듀얼-홈드-게이트웨이dual-homed-gateway-방식)<br>
   &nbsp;&nbsp;3-6. [스크린드 호스트 게이트웨이(Screened Host Gateway)](#스크린드-호스트-게이트웨이screened-host-gateway-방식)<br>
   &nbsp;&nbsp;3-7. [스크린드 서브넷 게이트웨이(Screened Subnet Gateway)](#스크린드-서브넷-게이트웨이screened-subnet-gateway)<br>
4. [VPN(가상사설망)](#vpn가상사설망)<br>
5. [Snort(스노트)](#snort스노트)<br>
6. [Suricata(수리카타)](#suricata수리카타)<br>
7. [iptables](#iptables)<br>
   &nbsp;&nbsp;7-1. [iptables를 이용한 필터링 로그](#iptables를-이용한-필터링-로그)<br>
8. [Packet Filtering(패킷 필터링)](#packet-filtering패킷-필터링)<br>
9. [NAC(Network Access Control)](#nacnetwork-access-control)<br>
10. [SSO(Single Sign On)](#ssosingle-sign-on)<br>
11. [EAM(Extranet Access Management)](#eamextranet-access-management)<br>
12. [IAM(Identity and Access Management)](#iamidentity-and-access-management)<br>
13. [ModSecurity](#modsecurity)<br>
14. [EDR(Endpoint Detection and Response) 솔루션](#edrendpoint-detection-and-response-솔루션)<br>
    &nbsp;&nbsp;14-1. [EDR과 백신의 차이점](#edr과-백신의-차이점)<br>
15. [통합보안시스템(UTM : Unified Threat Management)](#통합보안시스템utm--unified-threat-management)<br>
16. [트러스트 존(Trustzone)](#트러스트-존trustzone)<br>
17. [DRM(Digital Rights Management)](#drmdigital-rights-management)<br>
    &nbsp;&nbsp;17-1. [DRM의 구성요소](#drm의-구성요소)<br>
18. [ESM(Enterprise Security Management)](#esmenterprise-security-management)<br>
    &nbsp;&nbsp;18-1. [ESM의 구성요소](#esm의-구성요소)<br>
19. [SIEM(Security Informantion & Event Management) 솔루션](#siemsecurity-information--event-management-솔루션)<br>
    &nbsp;&nbsp;19-1. [SIEM의 주요 기능](#siem의-주요-기능)<br>
20. [보안관제 모니터링 방법](#보안관제-모니터링-방법)<br>
    &nbsp;&nbsp; 20-1. [보안장비 모니터링](#보안장비-모니터링)<br>
    &nbsp;&nbsp; 20-2. [서버 모니터링](#서버-모니터링)<br>
    &nbsp;&nbsp; 20-3. [트래픽 모니터링](#트래픽-모니터링)<br>
21. [보안 관제 및 대응 절차](#보안-관제-및-대응-절차)<br>
22. [보안장비의 취약점](#보안장비의-취약점)<br>
23. [사이버 위기 경보 단계](#사이버-위기-경보-단계)<br>
24. [Wireshark(와이어 샤크)](#wireshark와이어-샤크)<br>
25. [DNS 프로토콜의 flag 비트를 필터링하기 위한 주요 필터 구문](#dns-프로토콜의-flag-비트를-필터링하기-위한-주요-필터-구문)<br>
26. [Fuzzer(퍼저)](#fuzzer퍼저)<br>
27. [Fuzzing(퍼징)](#fuzzing퍼징)<br>
28. [Tripwire(트립와이어)](#tripwire트립와이어)<br>
29. [Nessus(네서스) 점검 도구](#nessus네서스-점검-도구)<br>
30. [Nikto(닉토) 점검 도구](#nikto닉토-점검-도구)<br>
31. [Backdoor(백도어)](#backdoor백도어)<br>
32. [proc](#proc)<br>
33. [Rootkit](#rootkit)<br>
34. [리눅스 chatter 명령어](#리눅스-chatter-명령어)<br>
35. [유닉스/리눅스 strace 명령](#유닉스리눅스-strace-명령)<br>
36. [Reverse Engineering(리버스 엔지니어링)](#reverse-engineering리버스-엔지니어링)
37. [Register(레지스터)](#register레지스터)<br>
    &nbsp;&nbsp;37-1. [EAX(Extended Accumulator Register)](#eaxextended-accumulator-register)<br>
    &nbsp;&nbsp;37-2. [EBP(Extended Base Pointer)](#ebpextended-base-pointer)<br>
    &nbsp;&nbsp;37-3. [ESP(Extended Stack Pointer)](#espextended-stack-pointer)<br>
    &nbsp;&nbsp;37-4. [EIP(Extended Instruction Pointer)](#eipextended-instruction-pointer)<br>
38. [어셈블리어](#어셈블리어)<br>
    &nbsp;&nbsp;38-1. [피연산자가 없는 경우](#피연산자가-없는-경우)<br>
    &nbsp;&nbsp;38-2. [피연산자가 1개인 경우](#피연산자가-1개인-경우)<br>
    &nbsp;&nbsp;38-3. [피연산자가 2개인 경우](#피연산자가-2개인-경우)<br>
39. [Exploit(익스플로잇)](#exploit익스플로잇)<br>
    &nbsp;&nbsp;39-1. [Shell Code(쉘 코드)](#shell-code쉘-코드)<br>
    &nbsp;&nbsp;39-2. [NOP(No Operation) 명령](#nopno-operation-명령)<br>
40. [RET(어셈블리어 RET)](#ret어셈블리어-ret)
41. [윈도우 레지스트리(Registry) 최상위 루트 키(RootKey)](#윈도우-레지스트리registry-최상위-루트-키rootkey)<br>
    &nbsp;&nbsp;41-1. [HKCR(HKEY_CLASSES_ROOT)](#hkcrhkey_classes_root)<br>
    &nbsp;&nbsp;41-2. [HKCU(HKEY_CURRENT_USER)](#hkcuhkey_current_user)<br>
    &nbsp;&nbsp;41-3. [HKLM(HKEY_LOCAL_MACHINE)](#hklmhkey_local_machine)<br>
    &nbsp;&nbsp;41-4. [HKU(HKEY_USERS)](#hku-hkey_users)<br>
    &nbsp;&nbsp;41-5. [HKCC(HKEY_CURRENT_CONFIG)](#hkcchkey_current_config)<br>
42. [DBD(Drive By Download) 공격](#dbddrive-by-download-공격)<br>
43. [Obfuscation(난독화)](#obfuscation난독화)<br>
44. [Ransomware(랜섬웨어)](#ransomware랜섬웨어)<br>
    &nbsp;&nbsp;44-1. [Ransomeware 예방 수칙](#ransomware-예방-수칙)<br>
    &nbsp;&nbsp;44-2. [Ransomeware 감염 대응 절차](#ransomware-감염-대응-절차)<br>
45. [Hoax(혹스)](#hoax혹스)<br>
46. [Joke(조크)](#joke조크)<br>
47. [트로이 목마(Trojan Horse)](#트로이-목마trojan-horse)<br>
48. [Key Logger Attack(키로거 공격)](#key-logger-attack키로거-공격)<br>
49. [웜(Warm)](#웜warm)<br>
50. [바이러스(Virus)](#바이러스virus)<br>
51. [Downloader(다운로더)](#downloader다운로더)<br>
52. [Dropper(드롭퍼)](#dropper드롭퍼)<br>
53. [Injecter(인젝터)](#injecter인젝터)<br>
54. [악성코드 분석 방법](#악성코드-분석-방법)<br>
    &nbsp;&nbsp;54-1. [동적 분석(Dynamic)](#동적-분석dynamic)<br>
    &nbsp;&nbsp;&nbsp;&nbsp;54-1-1. [샌드박스(sandbox)](#샌드박스sandbox)<br>
    &nbsp;&nbsp;54-2. [정적 분석(Static)](#정적-분석static)<br>
55. [YARA(야라)](#yara야라)<br>
56. [Slack Space(슬랙 공간)](#slack-space슬랙-공간)<br>
    &nbsp;&nbsp;56-1. [RAM Slack(램 슬랙)](#ram-slack램-슬랙)<br>
    &nbsp;&nbsp;56-2. [Drive Slack(드라이브 슬랙)](#drive-slack드라이브-슬랙)<br>
    &nbsp;&nbsp;56-3. [File System Slack(파일 시스템 슬랙)](#file-system-slack파일-시스템-슬랙)<br>
    &nbsp;&nbsp;56-4. [Volume Slack(볼륨 슬랙)](#volume-slack볼륨-슬랙)<br>
57. [Supply Chain Attack(공급망 공격)](#supply-chain-attack공급망-공격)<br>
58. [DDE(Dynamic Data Exchange)](#ddedynamic-data-exchange)<br>
    &nbsp;&nbsp; 58-1. [DDE 공격 대응법](#dde-공격-대응법)<br>
59. [ATP(Advancde Persistent Threat)](#aptadvanced-persistent-threat)<br>
60. [Watering Hole(워터링 홀)](#watering-hole워터링-홀)<br>
61. [Spear Phishing(스피어 피싱)](#spear-phishing스피어-피싱)<br>
62. [Cryptojacking(크립토재킹)](#cryptojacking크립토재킹)<br>
63. [Cyber Kill Chain(사이버 킬 체인)](#cyber-kill-chain사이버-킬-체인)<br>
64. [MITRE ATT&CK](#mitre-attck)<br>
65. [Footprinting(풋프린팅)](#footprinting풋프린팅)<br>
66. [허니팟(Honey Pot)](#허니팟honey-pot)<br>
    &nbsp;&nbsp; 66-1. [허니팟 구성 조건](#허니팟honey-pot)<br>
67. [허니넷(Honey Net)](#허니넷honey-net)<br>
68. [제로데이(zero day) 공격](#제로데이zero-day-공격)<br>
69. [CVE(Common Vulnerability & Exposures)](#cvecommon-vulnerability--exposures)<br>
70. [CVSS(Common Vulnerability Scoring System)](#cvsscommon-vulnerability-scoring-system)<br>
71. [CWE(Common Weakness Enumeration)](#cwecommon-weakness-enumeration)<br>
72. [CWSS(Common Weakness Scoring System)](#cwsscommon-weakness-scoring-system)<br>

# IDS(: Intrusion Detection System 침입탐지시스템)

- 사전에 등록한 알려진 공격 패턴, 임계치 등을 기반으로 공격 행위를 탐지하는 보안장비이다.
- 패킷의 내용이나 시스템 로그 등을 분석하여 악의적인 공격 여부를 판단한다.
- 침입 탐지 방식에 따라 `오용 탐지 방식과 이상 탐지 방식`으로 나눌 수 있다.
- 탐지할 데이터 수집원에 따라 `호스트 기반 IDS과 네트워크 기반 IDS`으로 구분할 수 있다.
- 탐지 장비들의 공격 행위 탐지 결과는 정탐(true positive)뿐만 아니라 오탐 및 미탐이 발생할 수 있다.
  - 탐지 결과의 심각성 관점에서 볼 때 오탐보다 미탐이 더 심각한 상황이므로, 미탐을 줄이는 것이 매우 중요하다.
    - 정탐(true positive) -> 공격 행위를 정확히 탐지
    - 오탐(false positive) -> 공격 행위가 아닌 것을 공격 행위로 탐지
    - 미탐(false negative) -> 공격 행위를 탐지하지 못함

## 오용 탐지(misuse detection)

- 사전에 등록한 알려진 공격 패턴을 기반으로 공격 행위를 탐지하는 방식이다.
- 지식 기반 탐지 또는 시그니처 기반 탐지라고도 한다.
- 알려진 공격 패턴을 기반으로 탐지하기에, 지속적인 공격 패턴 갱신이 필요하다.
- 상대적으로 오탐률이 낮지만, 새로운 공격에 대해선 탐지할 수 없다. 즉, 미탐률이 높다.

## 이상 탐지(anomaly detection)

- 정량적이고 평균적인 상태를 기준으로, 이를 벗어난 행위를 공격 행위로 탐지하는 방식이다.
- 행위 기반 탐지 또는 통계 기반 탐지라고도 한다.
- 정량적이고 통계적인 분석을 통해 측정한 정상 행위와 비정상 행위를 구분할 수 있는 임게치를 기반으로 탐지하는 방식이다.
- 임계치 설정을 위한 학습 과정에 많은 시간과 데이터가 필요하다.
- 알려지지 않은 새로운 공격도 탐지가 가능하므로 미탐률이 낮지만, 정상 행위와 비정상 행위를 구분하는 임계치 설정이 어려워 오탐률이 높다.

## 호스트 기반 IDS(HIDS : Host based IDS)

- 호스트에 설치되어 호스트 정보를 수집하여 탐지 활동을 수행하는 IDS이다.
- 호스트 내부에 설치되어 호스트 정보를 수집하여, 관리자 권한을 획득하거나 시스템을 변조하는 등의 내부 공격을 탐지한다.
- 대표적인 `오픈소스 HIDS로 트립와이어(tripwire)가 있다.`
  - 호스트 파일시스템의 파일 무결성을 점검하는 도구로 사용된다.
- HIDS는 단일 호스트 기반 IDS와 다중 호스트 기반 IDS로 세분화할 수 있다.
  - 단일 호스트 기반 IDS(Single Host based IDS)
    - 단일 호스트로부터 정보를 수집하여 탐지하는 방식이다.
    - 호스트에서 실행되는 인텔리전트한 특정 프로그램이 OS를 계속해서 감시, 모니터링하고 그 결과를 로그파일에 저장하고 이벤트를 발생시키며 부정한 행위가 탐지되었을 경우 관리자에게 알려준다.
  - 다중 호스트 기반 IDS(Multi Host based IDS)
    - 여러 호스트로부터 정보를 수집하여 탐지하는 방식이다.
    - 각각의 단일 호스트에 인텔리전트한 특정 프로그램이 클라이언트의 기능으로 실행되고 특정 서버는 자료를 모으는 서버 역할을 하여 다른 클라이언트 시스템에 저장된 로그파일을 취합하여 분석하고 통계를 작성하여 보고하도록 구성된 시스템이다.

## 네트워크 기반 IDS(NIDS : Network based IDS)

- 네트워크 트래픽을 수집하여 탐지 활동을 수행하는 IDS를 말한다.
- 네트워크 특정 지점에 설치되어 네트워크 트래픽 정보를 수집하여 취약점 스캐닝, 네트워크 공격 등을 탐지한다.
- `대표적인 오픈소스 NIDS로 스노트(snort)와 스노트의 단점을 보완한 수리카타(Suricata)가 있다.`
  - 수리카타(Suricata)
    - 기존 스노트의 단일 스레드 방식을 개선하여 대용량 트래픽을 실시간으로 처리할 수 있도록 멀티 코어/멀티 스레드를 지원하며, 기존 스노트와도 완벼하게 호환된다.
- NIDS는 주로 미러링 모드(mirroring mode)로 설치한다.
  - 실제 트래픽에 대한 실시간 차단이 아닌 탐지 목적의 장비이기 때문

# IPS(: Intrusion Prevention System 침입 방지 시스템)

- IDS(침입탐지시스템)의 탐지 기능과 방화벽의 차단 기능을 결합하여, 비정상적인트래픽에 대한 실시간 방지를 수행한다.
- 침입방지시스템(IPS)은 사전에 등록한 알려진 공격 패턴, 임계치 등을 기반으로 `공격 행위를 탐지하고 실시간 차단까지 수행하는 보안장비이다.`
- 공격 행위 탐지 후 통보라는 수동적인 방어 개념의 침입탐지시스템(IDS)와 달리, 공격 행위가 탐지되면 이를 능동적으로 차단하는 보안 장비이다.
- IPS는 주로 인라인 모드(inline mode)로 설치한다.
  - 실제 트래픽에 대한 탐지뿐만 아니라 실시간 차단 목적의 장비이기 때문

# Firewall(방화벽)

- 프로토콜, IP 주소, Port 번호 등을 이용하여 정해진 정책에 따라 패킷 필터링을 수행하는 차단 장비이다.
- 네트워크 구간에 전송되는 패킷들을 정해진 규칙에 따라 차단하거나 통과시켜 공격자로부터 내부 자산을 보호하는 시스템이다.
- `네트워크를 내부와 외부로 구분하고, 설정한 보안 정책으로 부럽 접근을 차단한다.`
- 방화벽은 구축 방식에 따라 스크리닝 라우터(Screening Router) 방식, 듀얼 홈드 게이트웨이(Dual-Homed Gateway) 방식, 스크린드 호스트게이트웨이(Screened Host Gateway) 방식, 스크린드 서브넷 게이트웨이 방식(Screened Subnet Gateway) 방식으로 구분할 수 있다.

## Stateful Inspection 방화벽

- `패킷 필터링의 단점인 세션(session)에 대한 추적 기능을 보완한 방화벽`이다.
  - 기존 패킷 필터링 기능에 세션추적 기능을 추가했다.
    - 일련의 네트워크 서비스의 순서를 추적하여, 순서에 위배되는 패킷들은 모두 차단하게 된다.

## 방화벽의 Stateful Inspection 기능

- `패킷별 네트워크 및 전송 계층 정보만 보는 것이 아니라 일정 시간 동안 프로토콜의 상태정보를 유지`함으로써, 보다 빠르고 높은 보안성을 제공한다.
- 메모리상에 상태 흐름 테이블을 생성하여, `모든 송수신 패킷의 연결 상태(세션) 정보를 일정 시간 동안 유지`함으로써, 보다 빠르고 높은 보안성을 제공한다.
- `효율적인 방화벽 룰셋 설정`과 연결된 상태의 패킷인 것처럼 위조한 패킷의 접근을 차단할 수 있다.
- 연결된 상태의 패킷에 대해서는 추가적인 룰셋 검사를 수행하지 않으므로 성능상의 장점이 있다.

## Bastion Host(배스천 호스트)

- 중세 성곽의 가장 중요한 수비 부분을 의미하는 단어다.
- 방화벽 시스템 관리자가 중점 관리하는 시스템이다.
- 액세스 제어 및 응용 시스템 게이트웨이로서, 프록시 서버의 설치, 인증, 로그 등을 담당하는 호스트를 말한다.
  - 즉, `침입 차단 소프트웨어가 설치되어 내부와 외부 네트워크 사이에서 일종의 게이트웨이 역할을 하는 호스트`이다.
- 응용 게이트웨이 또는 회선 게이트웨이 방화벽이 설치된 안전성과 성능이 보장된 호스트이다.

## 스크리닝 라우터(Screening Router) 방식

- 패킷 필터링 기능을 이용하여, 방화벽 기능을 함께 수행하는 라우터다.
- 외부 네트워크(인터넷)와 내부 내트워크 경계에 있는 경계 라우터를 주로 이용한다.

## 듀얼 홈드 게이트웨이(Dual-Homed Gateway) 방식

- `두 개의 네트워크 인터페이스가 설치된 배스천 호스트`로, `하나의 인터페이스는 외부 네트워크(인터넷)와 연결`되고, `다른 하나의 인터페이스는 내부 네트워크에 연결`되어 `내부와 외부 사이의 접근 제어를 수행`한다.
- 스크리닝 라우터 방식과는 달리 `라우팅 기능은 존재하지 않는다.`

## 스크린드 호스트 게이트웨이(Screened Host Gateway) 방식

- 스크리닝 라우터(외부 스크리닝 라우터)와 싱글 또는 듀얼 홈드 게이트웨이를 조합하여 구성한 방식이다.
- `외부 네트워크(인터넷)에서 내부 네트워크로 들어오는 트래픽`은 `일차로 스크리닝 라우터에서 필터링`하고, 이를 통과한 트래픽에 대해 `이차로 싱글 또는 듀얼 홈드 게이트웨이에서 필터링`하는 방식이다.

## 스크린드 서브넷 게이트웨이(Screened Subnet Gateway)

- 스크리닝 라우터들(외부 스크리닝 라우터와 내부 스크리닝 라우터) 사이에 듀얼 홈드 게이트웨이를 조합하여 구성한 방식이다.
- 외부 네트워크(인터넷)와 내부 네트워크 사이에 DMZ(Demilitarized Zone)이라는 네트워크 완충지역 역할을 하는 서브넷을 운영하는 방식이다.

# VPN(가상사설망)

- 인터넷과 같은 공중망을 이용하여, 마치 사설망을 사용하듯 네트워크를 안전하게 연결하기 위한 통신 터널을 만들어 데이터를 안전하게 전송하는 시스템이다.

# Snort(스노트)

- Open Source 네트워크 침입탐지시스템(NIDS)이다.
- Network에서 실시간 Traffic 분석과 Packet logging을 수행하는 NIDS다.
- 프로토콜 분석, 콘텐츠 검색/비교 작업을 할 수 있으며, 다양한 공격과 스캔을 탐지할 수 있다.
- 패킷 로거, 스니퍼, 네트워크 침입 탐지 모드로 동작할 수 있으며, 그 중 스니퍼 모드는 단순히 네트워크에서 패킷을 읽어 콘솔에 출력한다.
- snort는 프로토콜 분석, 컨텐츠 검색, 취약점 악용 시도, 포트 스캔, 버퍼 오버플로우, OS fingerprinting, 웜 등의 다양한 공격을 탐지한다.

## Snort Rule

```
10번째 바이트부터 2바이트 범위에 FFFF 바이너리 패턴이 있는지 검사하기 위한 snort 룰

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"TEST"; content:|FFFF|; offset:9; depth:2; sid:1000001;)
```

```
패킷의 내용을 검사하여, "/administrator"란 문자열이 포함된 경우 "Web Scan Detected"란 메시지로 로깅을 하기 위한 snort 룰

alert tcp any any -> 192.168.159.131 80 (content:"/administrator"; msg:"Web Scan Detected";)
```

|  Rule   | 설명                                                                                                                             |
| :-----: | :------------------------------------------------------------------------------------------------------------------------------- |
| content | 페이로드에서 검사할 문자열을 지정한다.<br>문자열은 text 형식일 수도 있고 binary 형식일 수 있으며, 두 개가 복합된 형식일 수 있다. |
| offset  | 페이로드에서 content 패턴을 검사할 시작 위치로 페이로드의 첫 번째 바이트 위치가 0부터 시작한다.                                  |
|  depth  | offset부터 몇 바이트까지 검사할 것인지를 지정한다.                                                                               |
|   msg   | 메시지 로깅 시 이벤트 명을 지정하는 옵션이다.                                                                                    |

# Suricata(수리카타)

- 기존 snort의 단일 스레드 방식에서 벗어나 대용량 트래픽을 실시간으로 처리할 수 있도록 멀티 코어/멀티 스레드를 지원하며 기존 snort도 완벽하게 호환된다.
- Suricata 특징
  - 멀티코어 및 멀티 스레드 지원
  - snort 룰 완벽 호환 및 대부분 기능을 지원
  - 하드웨어 벤더의 개발 지원으로 하드웨어 가속 지원
  - 스크립트 언어(Lua) 지원

# iptables

- `리눅스 커널에 내장된 넷필터(netfilter) 기능을 관리하기 위한 도구`이다.
  - `Rule 기반의 패킷 필터링 기능` 등을 제공한다.
- linux 시스템에서 사용되고, 상태 검사(추적) 기능과 로깅 기능, 포트 포워딩 및 향상된 매칭 기능 등을 제공해준다.
- 많은 방화벽 장비에서 사용된다.
- iptables주요 기능
  - 상태 검사 기능 제공
  - NAT(네트워크 주소 변환) 기능 제공
  - 패킷 레벨에서의 로깅 기능 제공
  - 확장 모듈을 통한 다양한 추가 기능 제공

## iptables를 이용한 필터링 로그

```
[ACCESS_DROP] IN=eth1 OUT=00:0c****** SRC=192.168.12.15 DST = 10.10.10.20
LEN=150 ID=49165 PROTO=UDP SPT=4985 DPT=161 ~~
```

- UDP 프로토콜(PROTO)를 사용하고, 목적지 포트(DPT)가 161번이기에, SNMP 서비스에 대한 필터링이다.

# Packet Filtering(패킷 필터링)

- 방화벽의 가장 기본적인 기능이다.
- `설정된 규칙에 따라 패킷의 통과 여부를 결정하고, 외부 침입에 대한 일차적 방어 수단으로 활용`된다.
- OSI 모델에서 네트워크 계층과 전송 계층에서 패킷의 출발지 및 목적지 IP 주소 정보, 각 서비스의 포트 번호, TCP SYN 비트 등을 이용한 접속 제어를 한다.

# NAC(Network Access Control)

- 단말기가 `네트워크에 접속을 시도할 때 이를 제어하고 기능을 제공하는 네트워크 보안 솔루션`이다.
- 네트워크 통제 기능을 수행한다.
- 대표적인 오픈 소스 솔루션으로 PacketFence, FreeNAC 등이 있다.
- 허가받지 않은 단말의 접근이나 웜.바이러스 등 악성코드에 감염된 pc, 노트북, 모바일 단말기 등의 접속을 사전에 차단하여 전체 시스템을 보호하는 망 보안 솔루션이다.
- 주요 제공 기능으로는 네트워크 접속 인증, 네트워크 자산 접근권한통제, 격리 및 치료, 모니터링 등이 있다.
- 네트워크에 접근하는 접속 단말의 보안성 강제 및 필수 프로그램 설치 유도, 보안 무결성 확인, 접속 단말의 접근 제어 및 인증, IP 할당 및 IP 충돌 보호 등의 기능을 수행하는 보안장비(솔루션)이다.

# SSO(Single Sign On)

- 한 번의 사용자 인증으로 여러 시스템에 접근할 수 있는 통합 인증 솔루션이다.
- 단일 인증을 통해 여러 시스템에 접근함으로써 사용자의 편의성이 증대한다.

# EAM(Extranet Access Management)

- 모든 사용자에 대한 통합 인증(SSO)과 사용자별/그룹별 접근권한 통제를 담당하는 권한 관리 솔루션이다.

# IAM(Identity and Access Management)

- EAM을 보다 포괄적으로 확장한 보안 솔루션이다.
- 조직이 필요로 하는 보안 정책을 수립하고 자동으로 사용자에게 계정을 만들어주며, 사용자는 자신의 직무에 따라 적절한 계정 및 권한을 부여받을 수 있을 뿐만 아니라 사용자 정보의 변경과 삭제도 실시간 반영이 가능하다.

# ModSecurity

- `Trustwave사의 SpiderLabs에 의해 개발된 Apache, IIS 등의 웹서버에서 동작하는 공개 웹 방화벽`이다.
- `웹 애플리케이션 공격에 대한 탐지 및 차단 기능뿐만이 아니라 웹 애플리케이션에 대한 실시간 모니터링 및 로그 분석 기능을 제공`한다.

# EDR(Endpoint Detection and Response) 솔루션

- `엔드포인트(종단)에서 발생하는 악성 행위를 실시간으로 감지하고 이를 분석 및 대응`하여 피해확산을 막는 솔루션이다.
- 엔드포인트(종단)에서 동작하는 모든 프로세스들의 행위를 감지하여 악성으로 의심되는 행위를 판단하고, 이를 담당자에게 보고하여 분석 및 대응하도록 한다.
  - `알려지지 않은 보안 위협에 대한 사전 대응과 보안 담당자에게 엔드포인트에 대한 가시성을 제공한다.`

## EDR과 백신의 차이점

- 백신(AV 솔루션)은 알려진 악성코드의 패턴을 기반으로 탐지하므로, 알려지지 않은 악성코드에대해선 탐지하지 못하고, 엔진 업데이트에 시간이 소요되므로 실시간 대응이 어렵다.
- EDR은 엔드포인트에서 동작하는 프로세스의 행위 기반으로 탐지하기에, 알려지지 않은 악성 행위도 탐지할 수 있고 실시간 대응(엔드포인트 격리, 프로세스 중단/제거 등)이 가능하다.

# 통합보안시스템(UTM : Unified Threat Management)

- 방화벽, 침입탐지/방지시스템(IDS/IPS), VPN, 안티바이러스, 웹/이메일 필터링 등 다양한 보안 기능을 통합한 단일 장비이다.
- 다양한 보안 기능을 수행하므로, `경제성과 보안 관리 및 운영을 편리하게 할 수 있는 장점이 있지만, 단일 장비이므로 장애 발생 시 모든 보안 기능에 영향을 미치는 단점이 있다.`

# 트러스트 존(Trustzone)

- ARM사에서 개발한 하드웨어 기반의 보안 기술이다.
- 하나의 하드웨어 장치에 분리도니 두 개의 환경을 제공하여, 보안이 필요한 정보를 격리된 환경에서 안전하게 보호하는 기술이다.
  - 하나의 CPU를 2개의 가상공간인 `일반 구역(normal world)과 보안 구역(secure world)으로 분할`하여 모니터 모드(Monitor mode)로 관리한다.
  - `보안이 필요하지 않은 작업은 일반 구역에서 실행`되고, `보안이 필요한 작업은보안 구역에서 실행`된다.

# DRM(Digital Rights Management)

- 디지털 콘텐츠 저작권을 보호하기 위해 `저작권자가 배포한 디지털 자료나 하드웨어의 사용을 제어하고, 이를 의도한 용도로만 사용하도록 제한`하는데 사용되는 모든 기술이다.
- `특정 자료를 저작권자가 의도한 용도로만 사용하도록 제한하는데 사용되는 모든 기술을 지칭하기에, 복사방지, 위변조(템퍼링) 방지 등의 다양한 기술 보호 장치도 그 일부`라고 할 수 있다.

## DRM의 구성요소

- 식별자(Identifier)
  - 컨텐츠를 식별할 수 있는 식별자
- 메타데이터(Metadata)
  - 컨텐츠 생명 주기 내에서 저작권 관리에 필요한 정보(저작권자 정보, 유통 정보 등)
- 패키저(Packager)
  - 컨텐츠를 메타데이터와 함께 배포할 수있도록 묶어, 시큐에 컨테이너 포맷 구조를 만드는 프로그램이다.
- 시큐어 컨테이너(Secure Container)
  - 배포된 컨텐츠를 안전하게 유통하기 위해 전자적 보안 장치로 유통되는 컨텐츠의 배포 단위이다.
- DRM 제어기(DRM Controller)
  - 배포된 컨텐츠의 이용 권한을 통제하는 프로그램이다.

# ESM(Enterprise Security Management)

- 침입차단시스템, 침입탐지시스템, 가상사설망 등 다양한 `보안장비에서 발생하는 보안 정보를 통합적으로 수집 및 관리`하여 불법적인 행위에 대응할 수 있도록 하는 보안 관리 시스템이다.

## ESM의 구성요소

1. ESM 에이전트(Agent)

- 관리 대상 보안장비에 설치되어 사전에 정의된 규칙에 따라 보안 정보를 수집하여 ESM 매니저로 전달하는 기능을 수행한다.

2. ESM 매니저(Manager)

- ESM 에이전트로부터 전달받은 보안 정보를 저장하고, 이를 분석한 결과를 ESM 콘솔로 전달하는 기능을 수행한다.

3. ESM 콘솔(Console)

- ESM 매니저로부터 전달받은 분석 결과에 대한 시각화, 조회 리포팅 등의 기능과 ESM 에이전트/매니저에 대한 제어 기능을 수행한다.

# SIEM(Security Information & Event Management) 솔루션

- 다양한 원천(보안 장비, 서버 장비, 네트워크 장비, 엔드포인트, 애플리케이션 등)으로부터 보안 정보를 수집하고, 빅데이터 기반의 상관관계 분석을 통해 보안 위협을 예측해내는 보안관제 솔루션이다.
  - 즉, `빅데이터 기반의 데이터 통합 및 상관 관계 분석 솔루션`이다.

## SIEM의 주요 기능

|     기능      | 설명                                                                                                                                                                                                                                                                     |
| :-----------: | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|  데이터 통합  | 다양한 원천에서 발생하는 보안 정보(이벤트, 로그 등)를 수집하여 통합한다.<br>- 정보(로그) 수집 : 관리 대상 장비에 설치된 에이전트 또는 SNMP, syslog 방식 등을 이용하여 정보를 수집한다.<br>- 정보(로그) 변환 : 다양한 정보 표현방식을 표준 형식으로 변환하는 과정이다.    |
| 상관관계 분석 | 수집한 보안 정보를 유용한 정보로 만들기 위해 다양한 상관관계 분석 기능을 제공한다.<br>- 정보(로그) 분류 : 이벤트 발생 누적 횟수 등 유사한 정보를 기준으로 그룹핑하여 단일 정보로 취합하는 과정이다.<br>- 정보(로그) 분석 : 여러 개의 정보 간 연관성을 분석하는 과정이다. |
|     알림      | 이벤트 발생 시 보안 담당자에게 자동으로 알린다.                                                                                                                                                                                                                          |
|   대시보드    | 분석한 결과에 대한 시각화, 조회 등의 기능을 제공한다.                                                                                                                                                                                                                    |

# 사이버 위협 인텔리전스(CTI : Cyber Threat Intelligence)

- 위협 인텔리전스(TI)라고도 한다.
- 단순한 위협 정보가 아닌 지능적 위협 정보를 말한다.
- 다양한 내.외부 조직에서 경험한 보안 위협 정보를 전문가 집단이 수집 및 분석하여 만들어 내는 증거 기반 위협 정보로 공격자, 공격 절차, 공격 방법, 업무 영향도, 공격 탐지 및 대응 방법 등 다양한 정보를 포함한다.
- SIEM, SOAR 등의 보안관제 솔루션에서 '사이버 위협 인텔리전스'와 연동하여, 보안 위협의 분석 및 대응에 활용한다.

# 보안관제 모니터링 방법

## 보안장비 모니터링

- 위협관리시스템(TMS), 침입차단시스템(Firewall), 침입탐지시스템(IDS) 등 네트워크 상황에 대한 실시간 감시 기능을 이용하여, 실시간 공격 정보, 네트워크 트래픽 상황을 확인한다.

## 서버 모니터링

- 주요 시스템에 대한 Health Check 모니터링 결과를 종합상황판에 표시하여 정기적으로 가용성 확보

## 트래픽 모니터링

- 인터넷 주요 구간의 패킷에 대한 흐름 상태를 종합상황판에 제공하여 상태를 관리

# 보안 관제 및 대응 절차

1. IDS, IPS 등 보안장비를 이용하여, 실시간 트래픽 현황과 공격 탐지 로그의 추이를 파악
2. 최초 이상 징후가 발생하면 관제 담당자에게 보고하고, 각각의 장비별 공격 탐지지표 현황을 비교, 분석하여 공격 탐지 여부를 결정
3. 해당 정보보호시스템 및 장비를 이용하여 공격에 대한 초동 조치 시행
4. 장비별 공격 탐지지표에 해당하는 정보를 수집하여 장비 간 상호 연관성 및 피해 내용 등을 고려하여 공격 유형을 식별하고 피해 범위를 분석한다.
5. 해당 공격에 대하여 공격유형 및 대응 매뉴얼에 따라 차단을 적용

# 보안장비의 취약점

1. 계정 관리

- 보안장비 기본(default) 계정 변경 취약점
  - 기본 계정은 장비 제조업체에서 출고 시 설정되어 나오는 기본 관리자 계정을 말한다.
  - 이를 변경하지 않고 사용할 경우, 공격자의 불법적인 접근이 발생할 수 있다.
- 보안장비 기본(default) 패스워드 변경 취약점
  - 기본 관리자 계정의 패스워드를 변경하지 않고 사용할 경우, 공격자의 불법적인 접근이 발생할 수 있다.
- 보안장비 계정별 권한설정 취약점
  - 계정별 권한 설정이 미흡할 경우 권한 없는 자에 의해 보안장비 설정 변경이 발생할 수 있다.
- 보안장비 계정관리 취약점
  - 불필요한 계정을 관리하지 않을 경우, 해당 계정을 통한 공격자의 불법적인 접근이 발생할 수 있다.

2. 접근 관리

- 보안장비 원격관리 접근 통제 취약점
  - 원격 접속 IP에 대해 접근 통제를 하지 않을 경우 공격자에 의한 계정 탈취가 발생했을 때 불법적인 접근이 발생할 수 있다.
- 보안장비 보안 접속 취약점
  - SSH, HTTPS 등의 보안 접속을 하지 않으면 공격자에 의한 스니핑 공격이 발생할 수 있다.
- 세션 타임아웃(session timeout) 설정 취약점
  - 세션 타임아웃을 설정하지 않으면 관리자의 부주의로 자리를 비운 사이에 권한 없는 자에 의한 악의적인 행위가 발생할 수 있다.

# 사이버 위기 경보 단계

|   단계    | 설명                                                                                                                                                     |
| :-------: | :------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 정상 단계 | 국내 민간분야 인터넷 정상 소통                                                                                                                           |
| 관심 단계 | 위험도가 높은 웜.바이러스 취약점 및 해킹 기법 출현으로 인해 피해 발생 가능성이 증가하고, 해외 사이버공격 피해가 확산하여 국내 유입이 우려되는 단계       |
| 주의 단계 | 일부 정보통신망 및 정보시스템의 잠애가 발생하고 침해사고가 다수 기관으로 확산할 가능성이 증가하는 단계                                                   |
| 경계 단계 | 복수 정보통신서비스제공자(ISP)망.기간통신망에 장애 또는 마비가 발생하고 침해사고가 다수 기관에서 발생했거나, 대규모 피해로 확대될 가능성이 증가하는 단계 |
| 심각 단계 | 국가 차원의 주요 정보통신망 및 정보시스템 장애 또는 마비가 발생하고, 침해사고가 전국적으로 발생했거나 피해 범위가 대규모인 사고가 발생한 단계            |

# Wireshark(와이어 샤크)

- 와이어샤크가 제공하는 필터에는 캡처 필터(Capture Filter)와 디스플레이 필터(Display Filter)가 있다.
- 캡처 필드(Capture Filter)
  - 실시간 패킷을 캡처할 때 사용하는 필터로 BPF(Berkeley Packet Filter) 구문을 사용한다.
- 디스플레이 필터(Display)
  - 캡처된 파일에서 원하는 패킷을 필터링할 때 사용하는 필터로, 와이어샤크 고유한 구문을 사용한다.

## DNS 프로토콜의 flag 비트를 필터링하기 위한 주요 필터 구문

```
dns.flags.response==1
- response가 0인 것은 질의를 의미하고, 1인 것은 response를 의미한다.

dns.flags.authoritative==1
- authoritative가 0인 것은 recursive 네임 서버의 캐시에 저장된 응답을 의미하고, 1인 것은 authoritative 네임 서버로부터의 응답을 의미한다.

dns.flags.recdesired==1
- "recursive desired" flag를 줄인 표현으로, recdesired가 0인 것은 반복(iterative) 질의/응답을 의미하고 1인 것은 재귀(Recursive) 질의/응답을 의미한다.
```

# Fuzzer(퍼저)

- 애플리케이션의 보안취약점을 찾아내기 위한 도구이다.
- 목표 애플리케이션에 대한 다양한 데이터를 입력함으로써, 소프트웨어 오류를 유발하여 보안취약점을 찾아내는 목적으로 사용한다.

# Fuzzing(퍼징)

- 소프트웨어 보안 테스트 기법이다.
- 프로그램 실행 시 무작위 데이터를 입력하여 그 결과로 애플리케이션에 오류 등이 발생하면, 보안 취약점이 존재할 가능성이 크다고 판단하는 테스트이다.
- 테스트 분야에 따라 웹 퍼징, 네트워크 프로토콜 퍼징, 파일 포맷 퍼징, 메모리 퍼징 등으로 구분한다.

# Tripwire(트립와이어)

- `파일시스템의 무결성`을 점검하는 도구이다.
- 파일시스템 무결성 점검이란, 파일시스템의 상태 추적 및 허가받지 않은 변경 여부를 주기적으로 점검하여, 의심스러운 변화가 감지되면 이를 검사하고 복구하는 과정을 말한다.

# Nessus(네서스) 점검 도구

- 테너블(Tenable)사가 개발.배포하는 `취약점 점검 도구(스캐너)`이다.
- 로컬 또는 원격지에서 다양한 방법을 통해 시스템, 네트워크, 웹 애플리케이션 등의 알려진 취약점에 대한 점검을 수행하며 점검을 통해 취약점의 내용과 해결 방법을 상세하게 제공한다.

# Nikto(닉토) 점검 도구

- 웹서버 또는 웹 애플리케이션 `취약점을 점검할 수 있는 공개 점검 도구(스캐너)`로 방대한 취약점 데이터베이스를 이용하여 다양한 형태의 취약점을 스캔할 수 있다.

# Backdoor(백도어)

- 트랩도어(trap door)라고도 한다.
- 프로그램 개발이나 유지보수, 유사시 문제 해결을 위해 시스템 관리자나 개발자가 정상적인 절차를 우회하여, 시스템에 출입할 수 있도록 임시로 만들어 둔 출입문이다.
  - 시스템 설계자나 관리자에 의해 고의로 남겨진 시스템의 보안 허점이다.
- 응용 프로그램이나 운영체제에 삽입된 프로그램 코드이다.
- 시스템 접근에 대한 사용자 인증 등 정상적인 절차를 거치지 않고 응용 프로그램 또는 시스템에 접근할 수 있도록 한다.

# proc

- `커널이 관리하는 프로세스 자원, 커널 파라미터 등에 대한 상태정보를 파일 형식으로 보관`하고 있으며, 일반 파일시스템과 달리 디스크 영역이 아닌 `메모리 영역에 존재하는 가상 파일시스템으로 부팅 시마다 새롭게 생성`된다.
  - 메모리에만 임시로 존재하기에 `가상 파일시스템`이라 한다.
- 유닉스/리눅스 커널이 사용 중인 프로세스 자원, 커널 파라미터 등에 대한 상태정보를 관리하기 위해 파일 형식으로 정보를 보관하는 영역이다.
- proc 파일에는 PID별로 디렉터리가 생성되어 있다.
- proc 파일시스템은 디스크가 아닌 메모리 영역에 존재하는 파일시스템으로, 부팅 시 /proc 디렉터리에 마운트된다.
- 유닉스/리눅스 계열의 운영체제에서 프로세스와 다양한 시스템 정보를 계층적 파일 구조 형식으로 보여주는 특별한 파일시스템이다.

# Rootkit

- 해커들이 지속해서 자신의 존재를 숨기고, 루트 권한의 획득과 백도어 등의 기능을 수행하는 코드와 프로그램의 집합이다.

# 리눅스 chatter 명령어

- 리눅스 파일시스템에서 파일 속성을 설정하는 명령어이다.

```
사용법
chatter +-=[속성] [파일 or 디렉터리]
- 속성 추가시 +, 속성 제거시 -, 속성 설정시 =

chatter +i 파일명
- 해당파일에 읽기 전용(immutable) 속성을 추가한다.
- 해당 파일은 읽기만 가능하고, 내용 변경, 추가 및 파일 삭제가 불가능하다.

chatter +a 파일명
- 해당파일에 내용 추가(append)만 허용한다.
- 로그파일 같은 경우 변경, 삭제는 못하게 하고 추가만 가능하게 할 때 유용하다.

chatter +A 파일명
- 해당 파일의 접근 시간(Access Time)을 변경하지 않는다.
- 웹 사이트의 기본 페이지같이 빈번하게 접속하는 파일의 경우, 접근 시마다 access time에 대한 갱신이 발생하게 되는데, 해당 옵션을 설정하게 되면 access time을 변경하지 않기에, 오버헤드를 줄일 수 있다.
```

- chatter로 설정한 속성은 `lsattr 명령`으로 확인할 수 있다.

# 유닉스/리눅스 strace 명령

- strace 명령은 유닉스/리눅스 시스템에서 특정 프로그램의 `시스템 콜(system call)과 시그널(signal)을 추적하는데 사용하는 디버깅 도구`이다.

```
strace 명령을 사용하여 변조된 프로그램 식별
[root@Fedora11 kamja]# strace -e trace=open ps | more
open("/etc/ld.so.cache", O_RDONLY) = 3
open("/lib/libc.so.6", O_RDONLY) = 3
open("/usr/lib/locale/ro_RO/uboot/tec/pshid.dat", O_RDONLY) = 3

- ps 프로그램에 대해 open 시스템 콜(-e trace=open)을 추적하여 출력하도록 하고 있다.
- ps 프로그램이 변조되어 정상적인 ps 프로그램에서 볼 수 없는 특정 파일에 대한(pshid.dat) 파일과 파일 오픈(open) 시스템 콜이 발생한 것을 확인할 수 있다.
```

# Reverse Engineering(리버스 엔지니어링)

- 정적 분석, 동적 분석 등 실행파일로부터 원시 코드를 추정하는 기법이다.

# Register(레지스터)

- 처리 중인 데이터나 처리 결과를 임시 보관하는 CPU 내 고속의 기억 장치이다.

## EAX(Extended Accumulator Register)

- 산술(논리)연산 시 변수값 저장, 함수의 반환값 저장 등

## EBP(Extended Base Pointer)

- 스택 프레임의 시작 주소(기준 포인터)

## ESP(Extended Stack Pointer)

- 스택 프레임의 최상단(Top) 주소(포인터), PUSH/POP 명령에 따라 주소가 변한다.
  - 스택의 최상단(Top) 주소를 담고 있는 레지스터(RET 수행 시점에 스택 포인터는 복귀 주소(Return Address)영역을 가리키고 있다.)

## EIP(Extended Instruction Pointer)

- 다음에 실행할 명령어의 주소(포인터)
  - 다음에 실행할 명령어의 주소를 담고있는 레지스터이다.

# 어셈블리어

- 어셈블리어 명령 형식은 피연산자가 없거나, 여러 개의 피연산자로 이뤄져 있다.

## 피연산자가 없는 경우

- RET
  - CALL 명령을 통해 호출된 함수에서 수행을 마치고 원래 호출한 함수로 복귀하기 위해 사용하는 명령으로, `ESP 레지스타가 가리키는 값(수행 시점에 복귀주소(Return Address) 영역을 가리키고 있음)을 EIP 레지스터에 저장한다.`

## 피연산자가 1개인 경우

- PUSH EBP
  - 스택 포인터(ESP 레지스터)를 감소시킨 후, EBP 레지스터의 값을 스택 포인터가 가리키는 스택 영역에 저장한다.
- POP EBP
  - 스택 포인터(ESP 레지스터)가 가리키는 값을 EBP 레지스터에 저장한 후 스택 포인터를 증가시킨다.

## 피연산자가 2개인 경우

- MOV EBP, ESP
  - ESP 레지스터값은 EBP 레지스터에 저장한다.(이동시킨다.)
- ADD EAX, ECX
  - EAX 레지스터값과 ECX 레지스터값을 더해서 EAX 레지스터에 저장한다. (EAX = EAX + ECX)

# Exploit(익스플로잇)

- 소프트웨어나 하드웨어의 버그 또는 취약점을 이용하여 공격자가 의도한 동작이나 명령을 실행하도록 하는 코드나 행위이다.

## Shell Code(쉘 코드)

- Exploit 수행 시 공격자가 의도한 명령을 담고 있는 어셈블리어로 작성된 작은 크기의 코드이다.
- 좁은 의미의 쉘 코드는 쉘을 실행시키는 코드를 의미한다.
- 넓은 의미의 쉘 코드는 쉘을 실행시키는 것뿐만이 아니라 공격자가 원하는 작업을 수행하는 다양한 형태의 코드를 의미한다.

## NOP(No Operation) 명령

- `아무 기능도 수행하지 않는 명령`이다.
- 대표적인 형태는 인텔 x86 시스템에서 사용하는 NOP 명령으로, `기계어 코드의 헥사값은 '0x90'`이다.
- 프로그램에서 NOP 명령은 빈 영역을 채우기 위한 명령으로 해당 명령을 만나면 아무런 동작 없이 다음 명령으로 넘어간다.
- Exploit 코드에서 `NOP 명령을 삽입하는 이유는 쉘 코드가 위치한 메모리상의 주소를 정확히 알 수 없으므로, 실행 확률을 높이기 위해` 다수의 NOP 명령을 쉘 코드 앞에 삽입하여 해당 영역을 가리키기만 하면, NOP를 타고 최종적으로 쉘 코드가 실행되도록 하기 위함이다.
  - 이러한 기법을 `NOP Sled 기법`이라고 한다.

# RET(어셈블리어 RET)

- x86 계열에서 ESP 레지스터가 가리키는 값을 EIP 레지스터로 이동시키는 어셈블리 코드이다.
- `CALL 명령을 통해 호출된 함수에서 수행을 마치고 원래 호출한 함수로 복귀하기 위해 사용하는 명령이다.`
  - ESP 레지스터가 가리키는 값을 EIP 레지스터에 저장하는 기능을 한다.

# Windows PE(Portable Executable) 파일

- 윈도우 운영체제에서 사요하고 있는 실행파일 구조이다
- 실행파일이 적재되는 가상주소, Import/Export API 목록, 코드, 데이터 등의 정보를 관리하기 위해 파일 첫 부분에 여러 가지 구조체로 구서오디어 있다.

## Windows PE 파일의 IMAGE_SECTION_HEADER

- 각 섹션 데이터를 메모리에 로딩하고 속성을 설정하는데 필요한 정보를 담고 있다.
- 섹션(Section)은 PE 파일이 가상 주소 공간에 로드된 이후 프로그램 실행 코드, 데이터, 리소스 등 프로그램 실행에 필요한 정보를 배치한 영역을 말한다.

## IMAGE_SECTION_HEADER의 섹션 이름과 데이터 유형

| 섹션 이름 | 설명                                                                                  |
| :-------: | :------------------------------------------------------------------------------------ |
|  `.text`  | 프로그램 실행 코드를 담고 있는 섹션                                                   |
|  `.data`  | 읽기 쓰기가 가능한 데이터 섹션으로, 전역 변수와 정적 변수 등이 위치한다.              |
|  .rdata   | 읽기 전용 데이터 섹션으로 상수형 변수, 문자열 상수 등이 위치한다.                     |
|   .bss    | 초기화되지 않은 전역변수가 위치한다.                                                  |
| `.idata`  | import할 DLL과 API/함수들에 대한 정보를 담고 있는 섹션이다.                           |
|  .edata   | export할 DLL과 API/함수들에 대한 정보를 담고 있는 섹션이다.                           |
|   .rsrc   | 다이얼로그, 아이콘, 커서 등의 애플리케이션 리소스 관련 데이터들을 담고 있는 섹션이다. |

# 윈도우 레지스트리(Registry) 최상위 루트 키(RootKey)

## HKCR(HKEY_CLASSES_ROOT)

- 파일 확장명과 응용 프로그램의 연결 정보가 들어있고, 윈도우 시스템에 들어있는 개체들 및 응용 프로그램과 그 자동화에 대한 정보도 들어 있다.
- 인터페이스 기능에 대한 바로가기 관련 키도 들어 있다.

## HKCU(HKEY_CURRENT_USER)

- 현재 로그인 중인 사용자의 환경 설정(프로필) 정보를 갖고 있다.
- 주요환경 설정 정보에는 제어판 설정, 네트워크 연결, 응용 프로그램 등이 있으며 HKU 루트키에 있는 해당 사용자 정보에 대한 링크를 갖고 있다.

## HKLM(HKEY_LOCAL_MACHINE)

- 개별 사용자 단위가 아닌 시스템 전체에 적용되는 하드웨어(드라이버, 프린터, USB 등)와 응용 프로그램의 설정 데이터를 저장한다.

## HKU(HKEY_USERS)

- 사용자별로 존재하는 하이브 파일인 ntuser.dat 파일을 로드하여 생성된다.
- 다중 사용자 환경에서 사용자별로 키 항목을 생성하여 환경 설정(프로필) 정보를 저장한다.

## HKCC(HKEY_CURRENT_CONFIG)

- 현재 사용 중인 윈도우의 하드웨어 프로필 정보(디스플레이 정보, 폰트 정보 등)를 갖고 있다.

# DBD(Drive By Download) 공격

- 사용자가 홈페이지에 접속만해도, 자신의 의도와 무관하게 악성코드가 다운로드 되어 설치되는 공격이다.
- 일반적으로 난독화된 악성 스크립트를 통해 다수의 경유지/중계지를 거처 최종 유포지로 접속하여 악성코드를 다운로드하도록 유도한다.
  - 이때 악성코드 다운로드를 위해 사용자 PC에 설치되어 있는 OS, 브라우저, 문서 편집기, 뷰어 등의 응용프로그램 취약점을 익스플로잇(Exploit)하는 방식을 사용한다.

# Obfuscation(난독화)

- 프로그램 코드를 읽기 어렵게 만드는 기술이다.
- 사용자는 소스코드를 읽기 어렵지만, 컴퓨터는 읽고 실행 할 수 있다.
- 코드의 가독성을 낮춰 쉽게 분석되는 것을 방지하고, 패턴 기반의 보안장비를 우회하기 위한 목적으로 사용된다.

# Ransomware(랜섬웨어)

- 이용자의 데이터(시스템 파일, 문서, 이미지, 동영상 등)을 암호화하고, 복구를 위한 금전을 요구하는 악성코드이다.
  - 랜섬웨어는 다른 악성코드와 달리 감염된 시스템을 암호화시킨다.

## Ransomware 예방 수칙

1. 모든 소프트웨어는 최신 버전으로 업데이트하여 사용한다.
2. 백신 소프트웨어를 설치하고 최신 버전으로 업데이트한다.
3. 출처가 불명확한 이메일과 URL 링크는 실행하지 않는다.

- 이메일에 첨부된 MS오피스 파일의 매크로 기능을 허용하지 않는다.
- 이메일에 첨부된 스크립트 파일이나 실행파일은 실행하지 않는다.

4. 파일 공유 사이트에서 파일 다운로드 및 실행에 주의한다.
5. 중요 자료는 정기적으로 백업한다.

## Ransomware 감염 대응 절차

1. 증상 확인하기

|       증상       | 설명                                                                |
| :--------------: | :------------------------------------------------------------------ |
|  파일 사용 불가  | 파일 중 일부 혹은 전체가 읽을 수 없거나 열리지 않는 현상 발생       |
| 파일 확장자 변경 | 파일의 확장자가 바뀌거나 확장자 뒤에 특정 확장자가 추가된 현상 발생 |
|   부팅 불가능    | 운영체제 부팅이 완료되지 않고 감염 사실 화면 등을 볼 수 있다.       |

2. 피해 최소화를 위한 긴급 조치

|          조치           | 설명                                                          |
| :---------------------: | :------------------------------------------------------------ |
| 외부 저장장치 연결 해제 | 외부 연결장치로의 확산 차단                                   |
|      네트워크 차단      | 네트워크를 통한 랜섬웨어 확산 차단                            |
|      PC 전원 유지       | PC 종료 후 부팅이 불가능한 경우가 발생할 수 있으므로 전원유지 |
|     복구 방법 확인      | 랜섬웨어 유형 파악 후 복구 툴이 있는지 확인                   |

3. 신고하기

|    조치     | 설명                                                             |
| :---------: | :--------------------------------------------------------------- |
| 증거 남기기 | 감염 알림창과 암호화된 파일이 생성된 화면 캡처 및 저장           |
|  신고하기   | 신고기관 신고 및 증거물 제출(한국인터넷진흥원 사이버민원센터 등) |

4. 데이터 복구하기

- 이동식 저장매체에 데이터 백업
  - 추후 암호화된(감염된) 파일을 복구할 수 있도록 도구가 제공될 경우를 대비하여 백업 보관
- pc 포맷 및 운영체제 재설치, SW 최신 업데이트 적용
- 기존 백업 매체 연결 및 데이터 복구

# Malvertising(멀버타이징)

- 악성코드(Malware)와 광고(Advertising)의 합성어이다.
- `온라인 광고를 통해 악성코드를 유포`시키는 행위이다.
- 상대적으로 보안이 취약한 광고 서버를 해킹하여 불특정 다수를 공격하는 기법으로, 랜섬웨어 등 악성코드 유포 통로 중 하나이다.
- 사용자 모르게 PC를 감염시키기 때문에 최초 유포지를 파악할 수 없다.

# Hoax(혹스)

- 남을 속이거나 장난을 목적으로 퍼트리는 가짜 바이러스이다.
  - 거짓 정보를 토대로 메일을 보내 사용자를 속이는 방식의 협박성 사기 메일이다.

# Joke(조크)

- 악성코드의 일종이지만, 사용자에게 데이터 파괴 등 구체적인 피해를 입히진 않지만, 바이러스와 유사한 증상으로 사용자들을 놀라게 하는 프로그램이다.
- Delete_Game, Format_Game, Cokegift, Puzzle 등이 이에 속한다.

# 트로이 목마(Trojan Horse)

- 정상적인 소프트웨어의 형태를 띄지만, 악의적인 행위를 포함하고 있는 악성 코드이다.
- 특정한 환경이나 조건 혹은 배포자의 의도에 따라 정보 유출이나 자료파괴 등의 피해가 발생한다.
- 트로이 목마의 특징
  - 정상적인 기능을 하는 프로그램으로 가장한다.
  - 프로그램 내에 숨어서 악의적인 기능을 수행한다.
- `대표적인 트로이목마 프로그램으로 백오리피스, 넷버스, 스쿨버스 등이 있다.`

# Key Logger Attack(키로거 공격)

- 키보드 입력 시 입력한 키를 파일에 저장하는 프로그램이다.
- 공격 대상이 특정 사이트에 접속한다면, 접속한 ID와 패스워드 등의 특정 파일이나 원격지에 저장할 수 있다.
- 키로거는 레지스트리나 시작 프로그램 등에 등록되어 시스템 시작 시 자동으로 동작한다.

# 웜(Warm)

- `스스로 복제하여 전파되면서, 독립적으로 실행 가능`한 악성코드이다.
- 특별한 숙주 프로그램이나 파일에 의존하지 않으며, 네트워크를 통하여 다른 컴퓨터로 자신을 복제할 수 있다.
- 데이터나 시스템을 파괴할 수 있으며, 엄청난 양의 컴퓨터및 통신 자원을 사용하는 특징이 있다.

# 바이러스(Virus)

- 정상적인 파일이나 시스템 영역에침입하여, 그곳에 자신의 코드를 삽입하거나 설치하는(감염시키는) 악성코드이다.
- 자기복제는 가능하지만, 독립실행이 불가능하다.

# Downloader(다운로더)

- `악성코드에서 지정한 주소에 접속하여 추가 악성코드를 다운로드하여 실행시키는 악성코드`이다.
- 드롭퍼와 같이 백신 프로그램을 우회하는 목적으로 사용한다.

# Dropper(드롭퍼)

- `자신 내부에 포함된 데이터를 이용하여 악성코드를 생성`한다.
- 드롭되는 파일들은 일반적으로 드롭퍼 내부에 압축된 형태로 존재하기 때문에 백신 프로그램을 통한 탐지가 어렵고, 실제 실행을 해보지 않고선 확인이 어렵다.

# Injecter(인젝터)

- 드롭퍼의 특수한 형태로 파일을 생성하지 않고, `자신의 데이터를 이용해 바로 새로운 프로세스를 생성하여 메모리에 상주`시키는 형태의 악성코드이다.

# 악성코드 분석 방법

- 악성코드 분석방법은 `정적 분석`과 `동적 분석`으로 구분할 수 있다.

## 동적 분석(Dynamic)

- `악성코드를 직접 실행`시켜서 어떤 행위들이 나오는지 분석하고, 의심스러운 행위가 보이면 악성코드로 진단하는 방식이다.
- 이러한 동적 분석은 실행 과정에서 악의적인 행위를 통해 분석 시스템 및 주변 네트워크에 치명적인 피해를 일으킬 수 있기에, 동적 분석 시에는 `샌드박스 환경에서 수행`한다.

### 샌드박스(sandbox)

- 외부와 격리된 보호된 영역을 의미한다.
- 분석할 파일을 외부와 격리된 보호 영역에서 실행함으로써, 다른 시스템에 악영향을 미치지 않도록 미연에 방지한다.

## 정적 분석(Static)

- `악성코드를 실행하는 것이 아니`라 실행파일에 대한 디버거를 통한 API 호출 관계 분석, 파일 헤더 및 바이너리 내 문자열 분석 등을 통해 악성코드 여부를 판단한다.

# YARA(야라)

- `악성코드 샘플에 포함된 패턴을 이용하여 특성과 행위를 기준으로 악성코드를 분류하는 데 사용하는 도구`이다.
  - 단순히 텍스트 또는 바이너리 패턴뿐만이 아니라 파일이나 프로세스의 오프셋, 가상 메모리 주소 활용 및 정규표현식 등을 이용하여 다양한 룰을 생성할 수 있다.
- 비교적 간단한 문법의 YARA 룰을 작성하는 것만으로 악성코드 샘플이 특정 기능을 하는지, 명시된 조건이 포함되어 있는지 확인할 수 있어서 다양한 보안장비에서 널리 사용하고 있다.

# Slack Space(슬랙 공간)

- 저장매체의 `물리적인 구조와 논리적인 구조의 차이로 발생하는 낭비 공간`으로, `물리적으로 할당된 공간이지만 논리적으로 사용할 수 없는 공간`이다.
- 슬랙 공간에 데이터를 은닉하거나, 악성코드를 기록해두는 악의적인 목적으로 활용될 수 있다.

## RAM Slack(램 슬랙)

- 램에 저장된 데이터가 저장매체에 기록될 때 나타난다.

## Drive Slack(드라이브 슬랙)

- 클러스터의 사용으로 인해 낭비되는 공간이다.

## File System Slack(파일 시스템 슬랙)

- 파일시스템의 마지막 부분에 사용할 수 없는 공간이다.

## Volume Slack(볼륨 슬랙)

- 전체 볼륨 크기와 할당된 파티션 크기의 차이로 발생하는 낭비 공간이다.

# Supply Chain Attack(공급망 공격)

- S/W 개발사의 네트워크에 침투하여 소스코드를 수정하여, 악의적인 목적지 코드를 삽입하거나 배포를 위한 서버에 접근하여 악의적인 파일로 변경하는 방식을 통해, 사용자 PC에서 소프트웨어 설치 또는 업데이트 시 자동으로감염되도록 하는 공격이다.
- Supply Chain(공급망)은 제품이나 서비스가 공급자로부터 소비자에게 전달되기까지의 조직, 사람, 정보, 자원 등에 대한 시스템을 말한다.
- S/W 또는 H/W 개발 및 배포 과정을 살펴보면, 먼저 개발업체또는 제조업체를 통해 제품에 대한 개발이 이뤄지고 사용자에게 배포하는 과정을 거치게 된다.
- 공급망 공격은 이러한 공급망에 침투하여 사용자에게 전달되는 S/W나 H/W를 변조하는 형태의 공격을 말한다.

# DDE(Dynamic Data Exchange)

- MS 오피스 응용 프로그램간 데이터 전달을 위해 제공하는 프로토콜이다.
  - 윈도우 OS에서 응용 프로그램(주로 MS 오피스 프로그램) 간 데이터 전송을 위해 사용되는 기능을 말한다.
- 페이로드를 전달하는 문서 파일은 VBA 매크로 코드를 이용하지 않고도 악성 기능을 수행할 수 있다.
- 워드 파일(MS-Word)을 열 때 엑셀 파일에 있는 데이터를 가져와서 사용할 수 있다.
- 공격자는 이러한 DDE 기능을 악용하여 정상적인 엑셀, 워드 파일로 보이지만, 실행 시 악의적인 시스템 명령을 수행하여 악성 프로그램 다운로드, 데이터유츨 등의 행위를 수행하는 파일을 만들어 유포할 수 있다.

## DDE 공격 대응법

- 파일 열람 시 확장자와 알림창을 주의 깊게 확인하여 의심스러운 프로그램의 실행에 대해선 허용하지 않도록 한다.
- MS워드, 엑셀 등의 프로그램 옵션을 확인하여, DDE 기능에 대한 제한을 설정한다.

# APT(Advanced Persistent Threat)

- 일반적으로 `특정한 목표 대상에 대해 취약점을 파악`하고, 다양한 방법을 이용한 지속적인 공격 활동으로 정보 탈취, 시스템 파괴 등의 손상을 입히려는 새로운 공격 형태로 비교적 공격기법이 정교하여 탐지 및 차단이 어려운 공격기법이다.
  - 즉, `불특정 다수를 대상으로 하는 공격이 아닌, 특정 대상을 지정하여 공격하는 기법`이다.
  - 특정 대상을 겨냥하여 지속적으로 공격한다.

# Watering Hole(워터링 홀)

- APT 공격 기법 중 하나이다.
- `특정 공격 대상이 자주 방문하는 웹 사이트를 해킹하여 공격 대상이 해당 웹 사이트에 접근 시 악성코드가 유포`되도록 하는 공격기법이다.
- 워터링 홀 공격 순서

1. 공격자는 공격 대상이 자주 방문하는 웹 사이트를 파악한다.
2. 파악된 웹사이트들에 대해 취약점 유무 확인을 위해 테스트를 수행한다.
3. 취약점이 존재하는 웹 사이트를 발견하면 악성코드가 실린 웹 사이트로 리다이렉트(redirect) 시키는 자바스크립트 또는 HTML 코드를 삽입한다.
4. 악성코드가 실린 웹 사이트는 방문자 시스템을 감염시키기 위해 대기상태에 있다.

# Spear Phishing(스피어 피싱)

- 작살로 물고기를 잡는 작살 낚시에서 유래된 기법이다.
- 불특정 다수가 아닌 `특정인 또는 조직을 표적으로, 신뢰할만한 발신인이 보낸 것처럼 위장한 이메일을 통해 악성 웹 사이트로 유도하거나 악성 첨부 파일로 악성코드에 감염`시키는 일종의 온라인 사기행위이다.

# Cryptojacking(크립토재킹)

- 암호화폐를 뜻하는 크립토커런시(Cryptocurrency)와 납치를 뜻하는 하이재킹(Hijacking)의 합성어이다.
- 사용자의 커뮤터를 암호화폐 채굴에 이용하는 사이버 범죄이다.

# Cyber Kill Chain(사이버 킬 체인)

- APT(Advanced Persistence Threat) 고격의 대응책이다.
- 군사용으로는 적 미사일 기지에 대한 선제공격을 의미하며, `사이버공격에 대한 선제 대응책`이다.
- `사이버상 공격자의 공격단계 중 하나를 사전에 제거하면 실제 공격까지 이어지지 않는다는 점에 착안한 방어 전략`이다.

# MITRE ATT&CK

- Cyber Kill Chain의 7단계를 확장한 모델이다.
- 공격자로부터 발생한 일관된 공격 행동 패턴에 대한 분석을 기반으로, 공격자의 행위를 식별해 줄 수 있다.
- 실제 사이버공격 사례를 관찰한 후 공격자가 사용한 악의적인 행위에 대해서 공격 전략과 전술 관점으로 분석한 후, 다양한 공격 그룹의 공격기법들에 대한 정보를 분류해놓은(목록화) 표준적인 데이터이다.
- 다양한 사이버공격을 정의하고 설명하는 표준화된 프레임워크로 사이버공격 분석에 공통으로 사용할 수 있다.
- 다양한 사이버공격의 전략, 전술 그리고 절차(TTPs : Tactics, Techniques and Procedures)를 설명한 프레임워크
- 사이버 킬 체인은 각 단계에 따른 공격자의 행위를 시간의 흐름에 따라 나열한 것으로 단계별로 어떤 기술이 사용되는지와 관련된 공격 도구나 공격 그룹에 대한 정보와의 연결고리가 없다는 한계점을 개선했다.
- 공격 전략(Tactics) : 공격자의 공격 목표에 따른 행동을 다양하게 분류한다.
- 공격 전술(Techniques) : 공격자가 공격 목표에 대한 전략을 달성하기 위해 사용한 방법으로 분류된 전략에 따라 다양한 전술들이 존재한다.

# Footprinting(풋프린팅)

- 공격 대상에 대한 정보를 수집하는 사전 작업을 말한다.
  - 직접적인해킹을 하기 전, 침이 ㅂ시스템에 대한 정보를 모으는 활동이다.
- 침입하기 위한 공격 대상의 보안 취약점, 도메인 이름, IP 주소, 침입탐지시스템 설치 여부, 사용자 목록, 시스템의 하드웨어 사양, 사용 중인 네트워크 프로토콜, 인증 메커니즘 등의 다양한 정보 수집 활동이 이뤄진다.

# 허니팟(Honey Pot)

- `해커를 유인`하기 위해 의도적으로 실제 서비스는 실행되지 않고, 해당 서비스를 이용할 수 있는 것처럼 꾸며 놓은 컴퓨터 시스템으로 공격자의 공격 경로와 공격 수법을 알아내기 위한 목적으로 사용한다.
- 공격자들을 유인하기 위해 고의로 취약점을 내포하고 있는 서버를 만들어 공격을 수행하도록 하며, 이를 모니터링한다.
- 취약점에 대한 패치가 발표되기 전 이뤄지는 `제로데이 공격(zero day attack)을 탐지하기 위한 목적으로 활용`된다.

## 허니팟 구성 조건

- 해커에게 쉽게 노출되어야 한다.
- 쉽게 해킹할 수 있도록 구성해야 한다.
- 시스템을 구성하는 요소를 모두 갖춰야 한다.
- 시스템을 통과하는 모든 패킷 및 로그에 대한 분석이 가능해야 한다.
- 시스템 이벤트 발생 시 실시간 모니터링이 가능해야 한다.

# 허니넷(Honey Net)

- 다수의 허니팟으로 구성된 네트워크이다.
- 공격자의 공격 경로와 공격 수법을 파악하여 다양한 공격에 대처하기 위해 구축된 네트워크이다.

# 제로데이(zero day) 공격

- 보안취약점이 발견되고 이에 대한 보안 패치가 발표되기 전(배포되기 전) 이뤄지는 공격이다.

# CVE(Common Vulnerability & Exposures)

- CVE는 공개된 정보보안 취약점 및 노출에 대한 식별정보를 제공한다.
  - 동일한 취약성에 대해 해커와 보안업체 간 다르게 사용해온 명칭을 표준화한 목록이다.
    - 즉, 버그나 취약점을 통합해서 관리한다.

```
표기 방법 : CVE - 해당연도 - 취약점 번호
예시 : CVE - 2014 - 1234
```

# CVSS(Common Vulnerability Scoring System)

- 보안 취약점 평가 체계이다.
- 기본 기준, 시간적 기준, 환경적 기준을 고려햐여 취약점의 심각한 정도를 0.0부터 10.0까지 수치화하며, 숫자가 높을 수록 취약점의 심각도가 높음을 나타낸다.

# CWE(Common Weakness Enumeration)

- 보안 취약점 평가 체계이다.
- 소프트웨어에서 공통으로 발생하는 취약점을 체계적으로 분류한 목록이다.
- 소프트웨어 개발 생명 주기(SDLC : Software Development Life Cycle)에서 발생할 수 있는 모든 약점 목록을 포함 한다.

# CWSS(Common Weakness Scoring System)

- 보안 취약점 평가 체계이다.
- CWE에 등록된 취약점의 위험성을 정량화하기 위한 점수 체계이다.
