1. [데이터 링크 계층](#데이터-링크-계층)<br>
   &nbsp;&nbsp; 1-1.[데이터 링크 계층에서 수행하는 기능](#데이터-링크-계층에서-수행하는-기능)<br>
   &nbsp;&nbsp; 1-1-1.[정지-대기 기법(Stop and Wait)](#정지-대기-기법stop-and-wait)<br>
   &nbsp;&nbsp; 1-1-2.[슬라이딩 윈도우(Sliding Window)](#슬라이딩-윈도우sliding-window)<br>
2. [CSMA/CD](#csmacd-carrier-sense-multiple-accesscollision-detection)<br>
3. [CSMA/CA](#csmaca-carrier-sense-multiple-accesscollision-avoidance)<br>
4. [L2-Switch 전송 방식](#l2-switch의-전송-방식)<br>
   &nbsp;&nbsp; 4-1. [Store and Forward 방식](#store-and-forward-방식)<br>
   &nbsp;&nbsp; 4-2. [Cut Through 방식](#cut-through-방식)<br>
   &nbsp;&nbsp; 4-3. [Fragment Free 방식](#fragment-free-방식)<br>
5. [Port Mirroring(포트 미러링)](#port-mirroring포트-미러링)<br>
6. [허브(더미 허브)](#허브더미-허브)<br>
7. [스위치(스위칭 허브)](#스위치스위칭-허브)<br>
8. [스패닝 트리(spanning tree)](#스패닝-트리spanning-tree)<br>
9. [유니캐스트(Unicast)](#유니캐스트unicast)<br>
10. [멀티캐스트(Multicast)](#멀티캐스트multicast)<br>
11. [브로드캐스트(Broadcast)](#브로드캐스트broadcast)<br>
    &nbsp;&nbsp;11-1. [MAC 주소에서 브로드캐스트 주소](#mac-주소에서-브로드캐스트-주소)<br>
    &nbsp;&nbsp;11-2. [3계층 IP 주소의 Direct 브로드캐스트 주소](#3계층-ip-주소의-direct-브로드캐스트-주소)<br>
12. [데이터 링크 계층(Data Link)](#데이터-링크-계층data-link)<br>
    &nbsp;&nbsp;12-1. [LLC(Logical Link Control)](#llclogical-link-control)<br>
    &nbsp;&nbsp;12-2. [MAC(Media Access Control)](#macmedia-access-control)<br>
13. [네트워크 계층](#네트워크-계층)<br>
    &nbsp;&nbsp; 13-1. [라우터(router)](#라우터router)<br>
14. [전송 계층(Transport)](#전송-계층transport)<br>
15. [표현 계층(Presentation Layer)](#표현-계층presentation-layer)<br>
16. [PDU(Protocaol Data Unit)](#pduprotocol-data-unit)<br>
17. [VLAN(Virtual LAN)](#vlanvirtual-lan)<br>
    &nbsp;&nbsp; 17-1. [VLAN 종류](#vlan-종류)<br>
18. [ARP(Address Resolution Protocol)](#arpaddress-resolution-protocol)<br>
19. [RARP(Reverse ARP)](#rarpreverse-arp)<br>
20. [ARP 스푸핑(Spoofing)](#arp-스푸핑spoofing)<br>
21. [스위치 재밍(Switch Jamming)](#스위치-재밍switch-jamming)<br>
22. [TTL(Time to Live)](#ttltime-to-live)<br>
23. [IP 데이터그램을 단편화할 때 tcpdump의 출력 형식](#ip-데이터그램을-단편화할-때-tcpdump의-출력-형식)<br>
24. [MTU가 1500바이트일 때 첫 번째 단편의 크기](#mtu가-1500바이트일-때-첫-번째-단편의-크기)<br>
25. [IP 스푸핑(Spoofing)](#ip-스푸핑spoofing)<br>
26. [트러스트 관계](#트러스트-관계)<br>
27. [IPv4에서 IPv6로 전환하는 방법](#ipv4에서-ipv6로-전환하는-방법)<br>
    &nbsp;&nbsp;27-1. [듀얼스택(Dual Stack)](#듀얼스택dual-stack)<br>
    &nbsp;&nbsp;27-2. [터널링](#터널링)<br>
    &nbsp;&nbsp;27-3. [주소/헤더 변환(Address / Header Translation)](#주소헤더-변환address--header-translation)<br>
28. [ICMP(Internet Control Message Protocol)](#icmpinternet-control-message-protocol)<br>
29. [ICMP Redirect 메시지](#icmp-redirect-메시지)<br>
30. [IGMP(Internet Group Management Protocol)](#igmpinternet-group-management-protocol)<br>
31. [TCP 프로토콜의 제어 플래그](#tcp-프로토콜의-제어-플래그)<br>
32. [소켓(Socket)](#소켓socket)<br>
33. [Well Known 포트(0~1023)](#well-known-포트0--1023)<br>
    &nbsp;&nbsp;33-1. [프로토콜과 포트번호](#프로토콜과-포트번호)<br>
34. [Registered Port(1024 ~ 49151)](#registered-port1024--49151)<br>
35. [TCP](#tcp)<br>
36. [UDP](#udp)<br>
37. [세션 하이재킹(Session Hijacking)](#세션-하이재킹session-hijacking)<br>
    &nbsp;&nbsp;36-1. [TCP 세션 하이재킹(TCP Session Hijacking)](#tcp-세션-하이재킹tcp-session-hijacking)<br>
    &nbsp;&nbsp;36-2. [HTTP 세션 하이재킹(HTTP Session Hijacking)](#http-세션-하이재킹http-session-hijacking)<br>
38. [NetBIOS(Network Basic Input/Output System)](#netbiosnetwork-basic-inputoutput-system)<br>
39. [CIFS(Common Internet File System)](#cifscommon-internet-file-systemsmbserver-message-block)<br>
40. [ping](#ping)<br>
41. [netstat 명령어](#netstat-명령어)<br>
    &nbsp;&nbsp;41-1. [netstat 명령어 옵션](#netstat-명령어-옵션)<br>
    &nbsp;&nbsp;41-2. [자주 사용하는 netstat 옵션 예시](#자주-사용하는-netstat-옵션-예시)<br>
42. [traceroute](#traceroute)<br>
43. [tracert](#tracert)<br>
44. [포트 스캐닝(Port Scanning)](#포트-스캐닝port-scanning)<br>
    &nbsp;&nbsp;44-1. [TCP 포트 스캔 방법](#tcp-포트-스캔-방법)<br>
    &nbsp;&nbsp;44-2. [TCP SYN 스캔 절차](#tcp-syn-스캔-절차)<br>
45. [스텔스 스캔(Stealth Scan)](#스텔스-스캔stealth-scan)<br>
46. [스니핑(Sniffing)](#스니핑sniffing)<br>
47. [스누핑(Snooping)](#스누핑snooping)<br>
48. [스푸핑(Spoofing)](#스푸핑spoofing)<br>
49. [도스 / 디도스(DoS / DDoS)](#도스--디도스dos--ddos)<br>
50. [Land Attack](#land-attack)<br>
51. [Fragment Overlap(단편 중첩 공격)](#fragment-overlap단편-중첩-공격)<br>
52. [Tiny Fragment 공격](#tiny-fragment-공격)<br>
53. [Ping of Death](#ping-of-death)<br>
54. [Smurf Attack](#sumrf-attack)<br>
    &nbsp;&nbsp;54-1. [Smurf Attack](#sumrf-attack)<br>
55. [TCP SYN Flooding Attack](#tcp-syn-flooding-attack)<br>
56. [DDOS 공격 도구](#ddos-공격-도구)<br>
    &nbsp;&nbsp;56-1. [Trinoo](#trinoo)<br>
    &nbsp;&nbsp;56-2. [TFN(Tribe Flood Network)](#tfntribe-flood-network)<br>
    &nbsp;&nbsp;56-3. [Stacheldracht](#stacheldracht)<br>
    &nbsp;&nbsp;56-4. [TFN2K](#tfn2k)<br>
57. [C&C 서버와 통신 채널을 형성하는 과정에서 보안장비로부터 탐지 및 차단되는 것을 방지하기 위한 우회 기법](#cc-서버와-통신-채널을-형성하는-과정에서-보안장비로부터-탐지-및-차단되는-것을-방지하기-위한-우회-기법)<br>
    &nbsp;&nbsp;57-1. [1. Fast Flux 기법](#1-fast-flux-기법)<br>
    &nbsp;&nbsp;57-2. [2. DGA(Domain Generation Algorithm) 기법](#2-dgadomain-generation-algorithm-기법)<br>
    &nbsp;&nbsp;57-3. [3. Domain Shadowing 기법](#3-domain-shadowing-기법)<br>
58. [HTTP GET Flooding](#http-get-flooding)<br>
59. [Slow HTTP Header DoS(Slowloris)](#slow-http-header-dosslowloris)<br>
60. [Slow HTTP POST Dos(RUDY)](#slow-http-post-dosrudy)<br>
61. [Slow HTTP Read DoS](#slow-http-read-dos)<br>
62. [DNS 증폭 공격(DRDoS)](#dns-증폭-공격drdos)<br>
63. [멤캐시드(Memcached)](#멤캐시드memcached)<br>
64. [WSD(WS-Discoery)](#wsdws-discovery)<br>
    &nbsp;&nbsp;64-1. [WSD 증폭/반사 공격](#wsd-증폭반사-공격)<br>
65. [ARMS(Apple Remote Management Service)](#armsapple-remote-management-service)<br>
    &nbsp;&nbsp;65-1. [ARMS 증폭/반사 공격](#arms-증폭반사-공격)<br>
66. [CoAP(Constrained Application Protocol)](#coapconstrained-application-protocol)<br>
    &nbsp;&nbsp;66-1. [CoAP 증폭/반사 공격](#coap-증폭반사-공격)<br>
67. [WEP(Wired Equivalent Privacy)](#wepwired-equivalent-privacy)<br>
68. [WPA](#wpa)<br>
69. [WPA2](#wpa2)<br>
70. [무선랜 보안기술 표준](#무선랜-보안기술-표준)<br>
71. [워 드라이빙(War Driving)](#워-드라이빙war-driving)<br>
72. [SSID(Service Set Identifier)](#ssidservice-set-identifier)<br>
    &nbsp;&nbsp;72-1. [무선 AP 보안 설정](#무선-ap-보안-설정)<br>
73. [NAT(Netword Address Translation)](#natnetword-address-translation)<br>
74. [가상 사설망(VPN : Virtual Private network)](#가상-사설망vpn--virtual-private-network)<br>
75. [2계층 VPN 프로토콜](#2계층-vpn-프로토콜)<br>
    &nbsp;&nbsp;75-1. [PPTP(Point to Point Tunnel Protocol)](#pptppoint-to-point-tunnel-protocol)<br>
    &nbsp;&nbsp;75-2. [L2F(Layer 2 Forwarding)](#l2flayer-2-forwarding)<br>
    &nbsp;&nbsp;75-3. [L2TP(Layer 2 Tunneling Protocol)](#l2tplayer-2-tunneling-protocol)<br>
76. [IPsec](#ipsec)<br>
    &nbsp;&nbsp;76-1. [AH(Authentication Header)](#ahauthentication-header)<br>
    &nbsp;&nbsp;76-2. [ESP(Encapsulating Security Payload)](#espencapsulating-security-payload)<br>
    &nbsp;&nbsp;76-3. [IKE(Internet Key Exchange) 프로토콜](#ikeinternet-key-exchange-프로토콜)<br>
    &nbsp;&nbsp;76-4. [전송 모드(Transport Mode)](#전송-모드transport-mode)<br>
    &nbsp;&nbsp;76-5. [터널 모드(Tunnel Mode)](#터널-모드tunnel-mode)<br>
    &nbsp;&nbsp;76-6. [IPSec을 통해 제공 되는 보안서비스](#ipsec을-통해-제공-되는-보안서비스)<br>
77. [터널링(Tunneling)](#터널링tunneling)<br>
78. [SSL / TLS](#ssl--tls)<br>
    &nbsp;&nbsp;78-1. [SSL(Secure Socket Layer)](#sslsecure-socket-layer)<br>
    &nbsp;&nbsp;78-2. [TLS(Transport Layer Security)](#tlstransport-layer-security)<br>
    &nbsp;&nbsp;78-3. [SSL/TLS을 구성하는 서브 프로토콜](#ssltls을-구성하는-서브-프로토콜)<br>
    &nbsp;&nbsp;&nbsp;78-3-1. [Handshake 프로토콜수행 절차](#handshake-프로토콜-수행-절차)<br>
    &nbsp;&nbsp;&nbsp;78-3-2. [Recode 프로토콜](#recode-프로토콜)<br>
79. [DTLS(Datagram Transport Layer Security)](#dtlsdatagram-transport-layer-security)<br>
80. [BEAST Attack(Browser Exploit Against SSL / TLS)](#beast-attackbrowser-exploit-against-ssl--tls)<br>
81. [CRIME Attack(Compression Ration Info-Leak Mass Exploitation)](#crime-attackcompression-ration-info-leak-mass-exploitation)<br>

# 데이터 링크 계층

- 인접한 노드 간의 신뢰성 있는 프레임 전송을 담당하는 계층이다.
  - 목적지 노드를 식별하기 위해선 물리적인 주소가 필요하며 네트워크 카드(NIC)의 MAC 주소가 해당 역할을 수행한다.
- 6바이트로 구성된다.
- MAC Address
  - 앞의 3바이트는 제조사(벤더) 코드, 뒤의 3바이트는 제조사(벤더)에서 할당한 코드이다.

## 데이터 링크 계층에서 수행하는 기능

1. 회선제어

- 점대점 또는 멀티포인트 회선 구성 방식과 단방향, 반이중 및 전이중 등의 통신방식에 따라 사용되는 전송링크에 대한 제어 규범이다.
- 데이터 통신 시스템에서 중앙 처리 장치와 복수의 통신 회선 사이에서 데이터의 상호 전송을 제어한다.
- 보통 회선 제어 장치에 의해 시분할 다중적으로 공통 제어된다.

2. 흐름제어

- 수신 장치의 용량 이상으로 데이터가 넘치지 않도록 송신장치를 제어하는 기술이다.
  - 즉, 수신 장치가 이전에 받은 데이터를 자신의 버퍼에서 처리하기 전 송신장치로부터 다른 데이터가 전송되지 않도록 하는 제어방식이다.
  - 정지 대기(Stop and Wait) 기법, 슬라이딩 윈도우(Sliding Window) 기법이 있다.
- 통신 당사자 간의 데이터 흐름을 규제하는 경우 송신 속도가 수신 측의 처리 능력을 초과하지 않도록 데이터 흐름을 조절한다.

3. 오류제어

- 여러 가지 원인으로 인해 전송된 데이터가 발생할 수 있는 오류에 대한 해결을 위한 제어방식이다.
- 전송 도중 발생한 부호 오류를 검출하고, 정확한 정보를 재현하는 기술 오류제어 기술로는 오류 정정 부호에 의하여 오류를 정정하는 순방향 오류 정정(FEC)과 오류 검출 부호를 사용하여 재송신하는 자동 재송 요구(ARQ)등이 있다.

### 정지-대기 기법(Stop and Wait)

- 흐름제어 기법 중 하나이다.
- 송신 측이 1개의 데이터를 전송하면 수신 측에서 오류 발생 여부를 점검하여 긍정 응답(ACK)이나 부정 응답(NAK)를 보낼 때까지 기다리는 방식이다.
  - 수신 측은 전송 중 오류가 발생하면 NAK를 보내고, 오류가 발생하지 않으면 ACK를 보낸다.
  - 이후, 다음 데이터를 전송하거나 NAK를 수신받으면 데이터를 재전송한다.

### 슬라이딩 윈도우(Sliding Window)

- 흐름제어 기법 중 하나이다.
- 한번에 여러개의 데이터를 보낼 수 있다.
- 수신 측에 보낼 수 있는 최대 크기(윈도우 크기) 내에서 수신 측 응답이 없어도 데이터를 연속해서 전송하는 방식이다.

# CSMA/CD (Carrier Sense Multiple Access/Collision Detection)

- 이더넷(IEEE 802.3) 표준에서 사용하는 매체 접근 제어 방식이다.
- 공유매체가 사용 중인지를 감지한 후 매체가 비어있다면 프레임을 전송하고, 전송 완료 이전에 신호 충돌을 탐지하여 충돌이 발생하면 임의의 시간 동안 대기한 후 재전송을 수행하는 접근 제어 방식이다.

# CSMA/CA (Carrier Sense Multiple Access/Collision Avoidance)

- 무선랜(IEEE 802.11) 표준에서 사용하는 매체 접근 방식이다.
- 무선랜 환경은 충돌 탐지가 어렵게 때문에 사전에 충돌을 회피하는 방식을 사용한다.
- 전송 전에 매체 사용 여부를 확인하고 일정 시간 대기후에 전송 및 수신 여부를 확인하여 실패 시 재전송을 수행하는 접근 제어 방식이다.

# 충돌 도메인(Collision Domain)

- 매체를 공유하는 LAN에서 하나의 장비가 데이터를 보내고 있을 때 또 다른 장비가 데이터를 동시에 보내면 충돌이 발생한다.

# 브로드케스트 도메인(Boradcast Domain)

- 어떠한 단말이 송신한 브로드 캐스트 패킷이 전달되는 허용 영역을 말한다.
- 영역 내에 있는 단말을 직접 통신이 가능하며, 허용 영역은 라우터 사용을 기준으로 분할된다.

# L2-Switch의 전송 방식

## Store and Forward 방식

- 유입된 전체 프레임을 버퍼에 저장하고 CRC 등의 오류 검사를 수행한 후 목적지로 전송하는 방식이다.
- 전체 프레임에 대한 오류 검사를 수행하기 때문에 신뢰성이 높지만, 지연 시간이 발생한다.

## Cut Through 방식

- 수신된 프레임의 첫 6byte를 읽어 `Destination MAC 주소(목적지 MAC 주소)만 검사한 후 즉시 목적지로 전송`하는 방식이다.
- 지연 시간이 줄어 빠른 전송이 가능하지만 프레임 오류 검사를 하지 않기에 신뢰성이 낮다.
- 스위치의 `중계 지연 시간(Forwarding Time Latency)을 최소화하기 위해 사용`되는 전송 방식이다.

## Fragment Free 방식

- Store and Forward 방식과 Cut Through 방식을 결합한 방식이다.
- 유입된 프레임의 첫 64byte를 버퍼에 저장하고, 충돌 등 오류 검사를 수행한 후 목적지로 전송하는 방식이다.

# Port Mirroring(포트 미러링)

- 스위치 환경에서 모니터링과 트래픽 분석을 위해 `특정 포트로 전달되는 패킷 또는 VLAN의 모든 패킷을 다른 모니터링 포트로 복제하여 전달`하는 기능이다.
  - 스위치는 허브처럼 `특정 포트에서 유입된 패킷을 모든 포트로 전달하지 않기 때문에 스위치로 전달되는 패킷을 분석하기 위해선 포트 미러링을 사용`해야 한다.

# 허브(더미 허브)

- 단일 네트워크 구간에서 사용된다.
- 한 포트에서 수신한 신호를 모든 포트로 전달할 뿐 트래픽을 조작하거나, 검사하지 않는다.
- 제어 기능이 없고, 충돌 도메인과 브로드캐스트 도메인을 구분하지 못하며, 연결된 모든 장비는 속도를 공유한다.

# 스위치(스위칭 허브)

- 단일 네트워크 구간에서 사용된다.
- 한 포트에서 수신한 신호를 목적지 포트로만 전달한다.
- 확장 제한이 없으며, 이중화시 스패닝 트리(spanning tree) 프로토콜을 이용하여 무한 루핑을 방지할 수 있다.

# 스패닝 트리(spanning tree)

- `스위치 이중화 시 루프가 생기는 것을 방지`하기 위한 프로토콜이다.
- `이중화 구성된 라인을 논리적으로 한 부분만 포트를 막는다.`
  - 만일, 사용 중인 라인에 문제가 발생하면 논리적으로 막은 포트를 다시 열어 링크를 연결한다.

# 유니캐스트(Unicast)

- `하나의 송신자`가 `하나의 수신자`에게 패킷을 보내는 방식이다.(특정인에게 전송)

# 멀티캐스트(Multicast)

- `하나의 송신자`가 `멀티캐스트 그룹의 수신자`에게 패킷을 보내는 경우이다.
  - `일대다`의 패킷 전송 방식이다.
- 멀티캐스트 전송을 수행하기 위해선 네트워크 장치가 멀티캐스트를 지원해야 하며, 멀티캐스트 그룹에 가입되어 있어야 한다.

# 브로드캐스트(Broadcast)

- `같은 네트워크에 있는 모든 호스트들에게 패킷을 보내는 방식`이다.
- 브로드캐스트 IP 주소에선 호스트 ID 비트를 모두 1로 설정해야 한다.(불특정 다수에게 전송)

## MAC 주소에서 브로드캐스트 주소

- 데이터 링크 계층(2 계층)에서 예약된 브로드캐스트 주소는 48비트 모두 1로 설정된 주소이다.
  - 8bit 단위 헥사값으로 :(콜론)을 구분자로 표현한다.
- `FF:FF:FF:FF:FF:FF`

## 3계층 IP 주소의 Direct 브로드캐스트 주소

- 해당 서브넷의 호스트 ID 비트가 모두 1인 주소를 말한다.
- 161.134.4.0/22 서브넷의 경우 하위 10비트가 모두 1인 주소가 Direct 브로드캐스트 주소가 된다.
  - 즉, 161.134.7.255가 Direct 브로드캐스트 주소이다.

# 데이터 링크 계층(Data Link)

- OSI 참조모델의 2번째 계층이다.
- 전송 데이터 단위로 `프레임`을 사용한다.
- 대표적인 장비로 `스위치, 브릿지` 등이 있다.
- 대표적인 보안 프로토콜로 `PPTP, L2F, L2TP` 등이 있다.
- 유/무선 LAN 기술의 주요 기능이 위치하는 곳이다.
  - ex) 이더넷, 토큰 링, FDDI, 802.11(무선랜/WIFI) 등이 해당한다.
- 데이터 패킷을 생성하고 전송하는 방법을 규정하는 프로토콜에 대한 계층이다.
- 데이터 링크 계층은 `하위 계층인 MAC 계층`과 `상위 계층인 LLC 계층으로 분류`할 수 있다.

## LLC(Logical Link Control)

- 장비 간 `논리적인 연결을 수립하고 제어`하는 역할을 담당하는 계층이다.
- 다양한 LAN 기술/프로토콜에서 공통으로 필요한 `회선제어, 흐름제어, 오류제어 등을 담당`한다.

## MAC(Media Access Control)

- 장비 간 공유 매체(공유 회선/링크)에 대한 `다중 접근 제어`를 담당하는 계층이다.
  - ex) 매체 접근 제어를 위해 이더넷은 CSMA/CD 방식을 사용한다.

# 네트워크 계층

- 송신 측으로부터 수신 측까지 데이터를 안전하게 전달하기 위해 논리적 링크를 설정한다.
  - 데이터가 목적지까지 올바르게 도달할 수 있도록 `경로 선택 및 라우팅 기능을 수행한다.`
- 상위 계층 데이터를 작은 크기의 패킷으로 나누어 전송하는 역할을 한다.
- 데이터 전송 단위로 `패킷`을 사용한다.
- IP 프로토콜이 대표적이다.

## 라우터(router)

- `네트워크 계층`에서 사용하는 장비이다.
- `패킷의 경로를 결정하며, 결정된 경로에 따라 패킷을 전송한다.`
- 패킷 필터링(ACL)을 통해 불필요한 트래픽 전송을 차단할 수 있다.
- QoS(Quality of Service) 기능을 통해 프로토콜이나 데이터의 크기, 중요도 등에 따라 트래픽 전송순서를 조절할 수 있다.

# 전송 계층(Transport)

- 데이터 전송 단위로 `세그먼트(segment)`를 사용한다.
- 대표적인 보안 프로토콜로 `SSL / TLS`가 있다.
- `종단 노드 간의(종단 프로세스 간) 신뢰성 있는 데이터 전송`을 담당한다.

# 표현 계층(Presentation Layer)

- 송수신 자가 정보를 이해할 수 있도록 `표현방식의 변환을 담당하는 계층`이다.
- `데이터 변환 기능`
  - 송신자와 사용하는 메시지 형식을 수신자가 해석할 수 있도록 미리 정의된 형식으로 변환하며, 수신지에선 수신자가 이해할 수 있는 형식으로 변환한다.
- `암호화 / 복호화`
  - 암호화와 복호화를 통하여 데이터의 보안성을 제공한다.
- `압축 / 압축해제`
  - 송신 측에선 데이터의 압축을 통하여 전송률을 높이고 수신 측에선 압축해제를 통해 데이터를 이용한다.
- `인코딩 / 디코딩`
  - 서로 다른 형태의 코드 변환을 수행한다.

# PDU(Protocol Data Unit)

- OSI 7 Layer 계층별 프로토콜의 데이터 단위를 의미한다.

1. Physical Layer(L1 : 물리 계층)[L1PDU] : `비트(bit)`
2. Data Link Layer(L2 : 데이터 링크 계층)[L2PDU] : `프레임(Frame)`
3. Network Layer(L3 : 네트워크 계층)[L3PDU] : `패킷(Packet)`
4. Transport Layer(L4 : 전송 계층)[L4PDU] : `세그먼트(Segment)`
5. Session/Presentation/Application Layer(L5 / L6 / L7 : 세션 / 표현 / 응용 계층) : `데이터(Data)`

# VLAN(Virtual LAN)

- 데이터링크 계층에서 `브로드캐스트 도메인을 나누기 위해 사용하는 기술`이다.
- `물리적인 네트워크 구조의 변경 없이 스위치에서 제공하는 기능을 통해 논리적으로 서브넷을 구성`할 수 있다.
- VLAN을 통해 가상의 브로드캐스트 도메인을 생성함으로써 브로드캐스트 트래픽을 제한하여 전체 네트워크 서비스의 성능 향상을 기대할 수 있다.
- `서로 다른 VLAN에 대해 서로 다른 보안 정책(네트워크 자원 접근 제한)을 적용할 수 있으므로 보안성을 높일 수 있다.`
- 즉, `네트워크 자원을 제한함으로써 보안성을 높일` 수 있고, `브로드캐스트 도메인의 크기를 줄여 브로드캐스트 트래픽 양을 줄이는 효과`가 발생하고 결과적으로 `전체 네트워크 서비스의 성능을 향상`시킬 수 있다.

## VLAN 종류

1. Port 기반 VLAN

- 스위치 포트를 각 VLAN에 할당한다.
- 같은 VLAN에 속한 포트에 연결된 호스트들 간에만 통신이 가능한 VLAN이다.

2. MAC 기반 VLAN

- 호스트들의 MAC 주소를 VLAN에 등록하여 같은 VLAN에 속한 MAC 주소의 호스트들 간에만 통신이 가능한 VLAN이다.
- 호스트들의 MAC 주소를 전부 등록하고 관리해야 하는 어려움이 있다.

3. 네트워크 주소 기반 VLAN

- 네트워크 주소별로 VLAN을 구성하여 같은 네트워크에 속한 호스트들 간에만 통신할 수 있도록 구성한 VLAN이다.

4. 프로토콜 기반 VLAN

- 같은 통신 프로토콜을 가진 호스트들 간에만 통신할 수 있도록 구현한 VLAN이다.

# ARP(Address Resolution Protocol)

- IP 주소 -> MAC 주소
- ARP 프로토콜은 로컬 네트워크의 모든 호스트에게 대상 IP를 가진 호스트의 MAC 주소를 질의하는 요청 메시지를 만들어 브로드캐스트로 요청하고, 대상 IP가 설정된 호스트는 자신의 MAC 주소를 담은 응답 메시지를 만들어 요청한 호스트에게 유니캐스트로 응답한다.
  - 즉, `요청 메시지를 전송할 때는 이더넷 프레임의 목적지 MAC 주소 필드에 브로드캐스트 주소인 FF:FF:FF:FF:FF:FF`(48bit 모두 1로 설정된 주소로 8bit 단위 헥사값으로 :(콜론)으로 구분된 표현)가 설정된다.

# RARP(Reverse ARP)

- MAC 주소 -> IP 주소

# ARP 스푸핑(Spoofing)

-`Spoofing = 속이기, 속임수`

- MAC 주소를 속이는 공격이다.
- 로컬에서 통신하고 있는 서버와 클라이언트의 IP 주소에 대한 2계층 `MAC 주소를 공격자의 MAC 주소로 속임`으로써 클라이언트에서 서버로 가는 패킷(혹은 서버에서 클라이언트로 가는 패킷)의 흐름을 왜곡시킨다.
  - 즉, 공격자가 다른 호스트의 MAC 주소를 자신의 MAC 주소로 위조한 응답 메시지를 만들어 지속적으로 희생자에게 전송한다.
    - 지속적으로 전송하면, 희생자의 캐시(Cache) 정보가 조작되어 희생자가 조작된 호스트로 패킷을 전송할 때 캐시에 저장된 조작된 MAC 주소로 데이터를 전송하게 된다.

# 스위치 재밍(Switch Jamming)

- MAC 플러딩(Flooding)이라고도 한다.
- 스위치 장비들은 `MAC 주소 테이블이 가득 차게 되면 모든 네트워크 세그먼트 트래픽을 브로드캐스트하는 특징`을 가지고 있다.
  - 즉, 공격자는 위조된 MAC 주소를 지속해서 네트워크에 흘림으로써 스위칭 허브의 주소 테이블을 오버플로우시켜 허브처럼 동작하게 하여 해당 네트워크 세그먼트의 데이터를 스니핑할 수 있게 된다.
    - 이는 스위치 장비들이 보안원리인 하나인 "Fail Close"를 따르지 않기 때문이다.
- 즉, `공격자가 만들어 낸 임의의 ARP 패킷의 MAC 주소가 스위치의 주소 테이블을 오버플로우 시키게 되면 공격이 성공`한다.

# TTL(Time to Live)

- IPv4에서 무한 루핑을 방지하기 위해 `라우터를 거칠 때마다 감소시키는 IP 헤더 필드명`이다.
- 목적지로 가기 위해 `IP 패킷이 경유할 수 있는 라우터의 개수(홉 카운터)`를 의미한다.
- 라우터를 거치면서 `TTL은 1씩 감소하며 목적지 도착 전에 TTL 값이 0이 되면 해당 패킷을 폐기한 후 ICMP 에러 메시지를 최초 출발지로 전송`한다.

# IP 데이터그램을 단편화할 때 tcpdump의 출력 형식

```
frag id:size@offset+
```

id

- 단편화 전 원본 IP 데이터그램을 식별 하기 위한 단편 ID를 의미한다.

size

- IP 헤더를 제외한 단편의 크기로 바이트 단위로 표시한다.

offset+

- 단편의 상대위치를 나타내며 +는 추가 단편이 있음을 의미하고, +가 없으면 마지막 단편을 나타낸다.

예)

```
frag 22666:48@2960+
```

- 단편(Fragment)의 ID는 22666이다.
- IP 헤더를 제외한 단편의 크기는 48을 의미한다.
- 2960+는 단편의 상대위치(Offset)가 2960이고, 추가 단편이 있음(+)을 의미한다.

# MTU가 1500바이트일 때 첫 번째 단편의 크기

- 첫 번째 IP 단편은 MTU에 따라 1500바이트이며, 이중 IP 헤더는 20바이트이다.
- 실제 데이터의 크기는 1500바이트에서 20바이트를 뺀 1480바이트이다.

# IP 스푸핑(Spoofing)

- Spoofing = 속임수
- 트러스트 관계가 맺어져 있는 서버와 클라이언트를 확인한 후 클라이언트에 DoS 공격을 하여 연결을 끊는다.
  - 그 후 공격자가 `클라이언트의 IP 주소를 확보하여 서버에 실제 클라이언트처럼 패스워드 없이 접근하는 공격`이다.
    - 트러스트 관계를 사용하지 않는 것이 최상의 대응책이다.

# 트러스트 관계

- `신뢰 관계에 있는 시스템 간에 별도의 로그인 없이 IP 기반의 인증을 수행하고 접속`하는 방식이다.
- `아이디와 패스워드를 사용하지 않기 때문`에 스니핑 공격에 의한 노출을막을 순 있지만, IP 스푸핑에는 취약하다.

# IPv4에서 IPv6로 전환하는 방법

## 듀얼스택(Dual Stack)

- IPv4와 IPv6 프로토콜을 동시에 설정하여 통신 상대에 따라 선택적으로 사용할 수 있도록 하는 방식이다.

## 터널링

- IPv4 네트워크를 경유하여 IPv6 네트워크 간 통신을 위한 방식이다.
- IPv4 네트워크를 통과 하는 가상의 경로(터널)를 만들어 통신하는 방법이다.

## 주소/헤더 변환(Address / Header Translation)

- 변환 헤더를 추가하여 IPv4 주소를 IPv6 주소로 변환하거나 IPv6 주소를 IPv4 주소로 변환하여 통신하는 방식이다.

# ICMP(Internet Control Message Protocol)

- IP 프로토콜의 비 신뢰적인 특성을 보완하기 위한 프로토콜이다.
- IP 패킷 전송 중 에러가 발생하면 에러 발생 원인을 알려주거나, 네트워크 상태를 진단하는 기능을 제공한다.
- 두 호스트 간, 또는 하나의 호스트와 라우터 같은 네트워크 장비 사이에서 에러 메시지를 주고받을 때 사용한다.
- TCP/IP 프로토콜 그룹에 속해 있으며, RFC 792에 의해 규정되어 있다.

# ICMP Redirect 메시지

- 호스트가 목적지 주소로 연결하고자 할 때, 해당 라우터가 최적의 경로를 호스트에게 다시 알려주기 위하여 라우터에서 호스트로 보내는 메시지이다.

# IGMP(Internet Group Management Protocol)

- 멀티캐스트를 지원하는 라우터가 멀티캐스트 그룹에 가입한 네트워크 내의 호스트를 관리하기 위해 사용하는 프로토콜이다.
- IGMP는 ICMP와 마찬가지로 IP 사우이 계층에 존재하며 IP 패킷으로 캡슐화되어 전송한다.

# TCP 프로토콜의 제어 플래그

| 플래그 | 의미                                                                                                                                                                                                                                               |
| :----: | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|  URG   | 수신 측에 긴급 데이터 전송을 알리는 제어 플래그(제어비트)                                                                                                                                                                                          |
|  ACK   | 송신 측에 보낸 데이터가 정상 수신되었음을 알리는 제어 플래그(제어비트)                                                                                                                                                                             |
|  PSH   | 즉시 처리가 필요한 데이터라는 것을 알리는 제어 플래그(제어 비트)<br>- 송신 측 동작 : 송신 버퍼(send buffer)에 있는 데이터를 즉시 전송한다.<br>- 수신 측 동작 : 수신 버퍼(receive buffer)에 있는 데이터를 상위 애플리케이션 계층으로 즉시 전달한다. |
|  RST   | 연결 중단(강제 연결 초기화)을 알리는 제어 플래그(제어비트)                                                                                                                                                                                         |
|  SYN   | 연결 설정을 알리는 제어 플래그(제어비트)                                                                                                                                                                                                           |
|  FIN   | 연결 종료(정상 연결 해제)를 알리는 제어 플래그(제어비트)                                                                                                                                                                                           |

# 소켓(Socket)

- 특정 IP 주소와 포트 번호의 조합이다.
- 같은 IP의 동일한 시스템이 동시에 특정 클라이언트의 복수 개의 응용 프로그램에 정확하게 통신할 수 있게 해주는 기반을 제공해주는 소프트웨어 모듈이다.
- 호스트/프로세스 간 통신을 위한 소프트웨어 모듈을 의미한다.
- 네트워크 프로그램 작성 시 OS에서 제공해주는 소켓 라이브러리를 이용하여 프로그래밍한다.

# Well Known 포트(0 ~ 1023)

- 잘 알려진 서비스에 할당된 포트이다.
- 관리자(root, admin)가 서버 프로세스(데몬)을 실행하기 위해 사용하는 포트이다.
- 일반 사용자가 해당 포트를 사용하면 권한 문제가 발생한다.

## 프로토콜과 포트번호

|   프로토콜   | 포트번호 | 설명                                                     |
| :----------: | :------: | :------------------------------------------------------- |
|  FTP, Data   |    20    | 파일 전송 프로토콜(FTP)의 데이터 채널                    |
| FTP, Control |    21    | 파일 전송 프로토콜(FTP)의 제어체널                       |
|    TELNET    |    23    | 터미널 네트워크(Terminal Network)                        |
|     SMTP     |    25    | 간단한 메일 전송 프로토콜(Simple Mail Transfer Protocol) |
|     DNS      |    53    | 도메인 네임 시스템(Domain Name System)                   |
|    BOOTP     |    67    | 부트스트랩 프로토콜(BOOTstrap Protocol)                  |
|     HTTP     |    80    | 하이퍼텍스트 전송 프로토콜(Hypertext Transfer Protocol)  |

# Registered Port(1024 ~ 49151)

- 일반 사용자가 서버 프로세스(데몬)를 실행하기 위해 사용하는 포트이다.
- 대표적으로 DBMS에서 사용하는 포트를 들 수 있다.
  - MySQL(3306/tcp), MS-SQL(1433/tcp), Oracle(1521/tcp)

# TCP

- 전송 계층에서 데이터 전송에 사용하는 프로토콜이다.
- `연결 지향적이고, 신뢰할 수 있는 특성`이 있다.

# UDP

- 전송 계층에서 데이터 전송에 사용하는 프로토콜이다.
- `비 연결형이고, 신뢰성은 보장하지 못하지만, 가볍고 빠른 전송이 가능`하다.

# 세션 하이재킹(Session Hijacking)

- 공격자가 `인증이 완료된 정상적인 사용자 세션을 중간에 가로채서 별도의 인증작업 없이 정상적인 사용자로 위장하여 가로챈 세션으로 통신하는 행위`이다.
- 정상적인 인증이 완료된 세션을 가로채기 때문에 사용자 인증기법을 사용한다고 해도 이를 무력화할 수 있다.

## TCP 세션 하이재킹(TCP Session Hijacking)

- TCP의 세션 관리 취약점을 이용한 공격이다.
- 정상 사용자의 `세션 관리 정보(출발지 IP, Sequence Number 등)를 위조하여 TCP 세션을 가로채는 공격`이다.
- 즉, `공격자는 정상적인 사용자의 출발지(Source) IP와 Port를 위조하고 순서번호(Sequence Number)를 예측하여 세션을 탈취`하게 된다.

## HTTP 세션 하이재킹(HTTP Session Hijacking)

- HTTP의 세션 관리 취약점을 이용한 공격이다.
- 정상 사용자의 `HTTP 세션 ID를 탈취하여 정상 사용자로 위장하여 서버에 접근하는 공격`이다.

# NetBIOS(Network Basic Input/Output System)

- IBM PC를 위한 네트워크 인터페이스 체계이다.
- `네임, 세션, 데이터그램`의 세 가지 서비스를 제공하고 있다.
- 윈도우 NT 시스템이 인터넷에 직접 연결되어 있으면 공격자가 쉽게 파일 시스템을 사용할 수 있으므로, netbios에 대한 접근통제가 적용되어야 한다.

netbios를 차단하기 위한 포트

- netbios : tcp/udp 135 ~ 139

# CIFS(Common Internet File System)[SMB(Server Message Block)]

- 주로 `윈도우 운영체제 환경에서 사용되는 파일, 프린터, 직렬 포트 등에 대한 공유 프로토콜`이다.
  - 유닉스/리눅스에선 삼바(SAMBA) 소프트웨어를 설치하면 SMB를 이용한 유닉스/리눅스와 윈도우 컴퓨터 간 공유가 가능하다.
- 초기 SMB는 NetBIOS API에서 동작했으며 TCP 139번 포트를 사용했다.
- 윈도우 2000이후 `CIFS(Common Internet File System)으로 명칭을 변경`했다.
  - `NetBIOS에 의존하지 않고 TCP 445번 포트를 사용한 직접 통신`을 지원한다.
- 네트워크에 연결된서로 다른 운영체제 간 자원을 쉽게 공유할 수 있지만, 여러 보안 취약점으로 인해 `컨피커 웜 바이러스, 워너크라이(워너 크립터) 랜섬웨어, 워너마인(WannaMine) 암호화폐 채굴 악성코드 등에 악용`되어 왔다.

CIFS(SMB)를 차단하기 위한 포트

- CIFS(SMB) : tcp 445

# ping

- `ICMP Echo Request 메시지를 특정 호스트에 송신하여, 이에 대한 ICMP Echo Reply를 수신`함으로써 호스트의 활성화 여부를 검사하고, `요청과 응답에 대한 경과 시간 RTT(Round Trip Time)을 알아볼 때 사용`한다.
- 원격 호스트에 대한 접근성(활성화 여부) 및 해당 구간에 대한 네트워크 속도(왕복 시간) 및 품질(손실률)을 검사하기 위한 명령어이다.

# netstat 명령어

- 시스템의 `네트워크 관련 다양한 상태정보를 확인할 수 있는 유닉스/리눅스/윈도우 시스템의 내장 명령어`이다.
  - 네트워크 인터페이스에 대한 정보, 라우팅테이블 정보, 소켓 상태정보, 프로토콜별 통계 정보 등 지정 옵션에 따라 다양한 네트워크 관련 정보를 제공한다.
- 공격자의 시스템 침입 경로를 확인하는 방법 중 `공격자가 현재 시스템과 통신하고 있는지 확인한다.`

## netstat 명령어 옵션

|        옵션        | 내용                                                    |
| :----------------: | :------------------------------------------------------ |
|     -l(listen)     | 연결 가능한 상태                                        |
|  -n(number port)   | 포트 넘버                                               |
| -r (routing table) | 라우팅 테이블                                           |
|      -p(PID)       | 프로그램 이름 / PID 번호                                |
|         -a         | 모든 상태의 소켓 정보를 출력한다.(LISTEN / ESTABLISHED) |
|         -s         | 네트워크 통계<br>기본값은 IP, ICMP, TCP, UDP이다.       |

## 자주 사용하는 netstat 옵션 예시

1. netstat -anp

- 연결을 기다리는 목록과 프로그램을 보여준다.

2. netstat -an | grep 포트번호

- 특정 포트가 사용중인지 확인한다.

3. netstat -nlpt

- TCP listening 상태의 포트와 프로그램을 보여준다.

4. netstat -anb

- 자세한 라이브러리까지 보여준다.

5. netstat -ano

- anb옵션 대용으로 사용되며, PID를 표시한다.

netstat 명령어 뒤에 숫자를 붙이면 숫자에 한번 씩 명령어를 실행한 결과가 출력된다.
ex) netstat 10 => 10초마다 한번 씩 명령어를 실행한 결과가 출력된다.

# traceroute

- `유닉스/리눅스` 시스템에서 'traceroute' 명령은 `종단 노드 사이에 있는 여러 중계 노드 각 구간에 대한 네트워크 상태를 관리하기 위한 명령어`이다.
- 최종 목적지 노드에 도달하는데 `경유하는 중계 노드(라우터)의 개수, IP 주소, 응답시간 등을 파악`할 수 있다.
- 목적지 호스트 포트(33434/udp 이상)로 `UDP 패킷의 TTL 값을 1씩 증가`시킨다.

1. 처음에는 IP 패킷의 TTL 필드값이 1인 패킷을 보낸다.
2. 이 패킷이 도달한 라우터에서는 TTL 필드값이 감소하게 되고 ICMP 프로토콜에 의해 시간초과 오류 메시지(Time Exceeded)를 출발지로 보낸다.
3. 다음은 TTL 필드 값이 2인 패킷을 보내 라우터 정보를 얻어오는 방식을 반복함으로써 최종 목적지까지의 경로를 확인할 수 있다.

# tracert

- 점검용 호스트에서 목적지 호스트까지 경유하게 되는 L3 장비(라우터 등)의 개수, IP 주소, 구간별 응답시간 등 네트워크 상태를 점검하기 위한 `윈도우 유틸리티 프로그램`이다.
- 목적지 호스트로 `ICMP Echo Request 패킷의 TTL값을 1씩 증가`시킨다.

1. L3 장비 구간의 네트워크 상태 점검을 위해 ICMP 프로토콜을 사용하여 패킷을 전송하는데, 이때 IP 헤더의 TTL 필드값을 1로 설정한다.
2. 해당 패킷이 첫 번째 L3 장비에 도착하면 TTL 필드값이 1 감소하여 0이되며 L3 장비는 TTL 필드값이 0인 패킷을 폐기하며, ICMP 프로토콜을 이용하여 최초 출발지로 패킷이 폐기되었음을 알린다.
3. 이 과정을 통해 L3 장비의 IP 주소와 구간 상태를 점검할 수 있으며, TTL 필드값을 1씩 증가시킴으로써 이후의 L3 장비들을 점검할 수 있다.

# 포트 스캐닝(Port Scanning)

- 공격자가 `침입 전 대상 시스템에 어떤 포트(서비스)가 열려있는지 확인`하는 작업이다.
- `대상 서버의 동작 여부와 제공하는 서비스 등을 확인할 수 있다.`

## TCP 포트 스캔 방법

|              스캔 방법               | 설명                                                                                                                                                                                                                                     |
| :----------------------------------: | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| TCP Full Open 스캔(TCP Connect 스캔) | 신뢰성 있는 결과를 얻을 수 있지만, `속도가 느리고 로그를 남기므로 탐지가 가능하다.`<br>- `포트가 열려 있을 경우 SYN/ACK 패킷을 수신하면, ACK 패킷을 전송함으로써 연결을 완료한다.`<br>- `포트가 닫혀 있을 경우 RST/ACK 패킷을 전송한다.` |
|             TCP SYN Scan             | `로그가 남지 않아 추적이 불가능한 기법이다.`<br>- `Full TCP 연결을 하지 않으므로, Half-Open 스캔이라 한다.`<br>- `포트가 닫히면 RST + ACK`응답<br>- `포트가 열리면 SYN + ACK` 응답                                                       |
|             TCP FIN Scan             | TCP 헤더 내에 FIN 플래그를 설정하여 공격 대상 시스템으로 메시지를 전송한다.<br>- `포트가 열려 있을 경우 응답이 없다.`<br>- `포트가 닫혀있을 경우 RST + ACK패킷이 되돌아온다.`                                                            |
|            TCP NULL Scan             | TCP 헤더 내에 플래그 값을 설정하지 않고, 전송한다.<br>- `포트가 열려 있을 때 응답이 없다.`<br>- `포트가 닫혀 있을 때 RST + ACK 패킷이 되돌아온다.`                                                                                       |
|            TCP XMAS Scan             | TCP 헤더 내에 ACK, FIN, RST, SYN, URG 플래그를 모두 설정하여 전송한다.<br>- `포트가 열려 있을 때 응답이 없다.`<br>- `포트가 닫혀 있을 때 RST + ACK패킷이 되돌아온다.`                                                                    |
|              Decoy Scan              | 스캔을 당하는 타겟 호스트에서 스캐너 주소를 식별하기 어렵도록 실제 스캐너 주소 외에도 다양한 위조된 주소로 스캐닝하는 기법이다.                                                                                                          |

## TCP SYN 스캔 절차

1. 공격자는 목표 시스템의 대상 포트로 연결요청을 위한 `SYN` 패킷을 전송한다.
2. 목표 시스템의 대상 포트가 `열린 상태이면 SYN + ACK 패킷을 공격자에게 응답`하고, 대상 포트가 `닫힌 상태이면 RST + ACK 패킷을 공격자에게 응답`한다.
3. 목표 시스템의 포트 오픈 여부를 확인한 공격자는 RST 패킷을 전송하여 TCP 연결 설정을 즉시 중단한다.

- 즉, 목표 시스템의 시스템 로그에 흔적을 남기지 않는다.

# 스텔스 스캔(Stealth Scan)

- 세션이 완전히 성립되지 않은 상태에서 공격 대상 시스템에 포트 활성화 여부를 알아내기에 `시스템에 로그가 남지 않는다.`
  - 즉, 공격 대상 시스템 관리자는 어떤 IP를 가진 공격자가 자신의 시스템을 스캔했는지 확인할 수 없다.
- 대표적인 `스텔스 스캔에는 TCP SYN Scan(Half-Open Scan), TCP FIN Scan, TCP NULL Scan, TCP Xmas Scan` 등이 있다.

# 스니핑(Sniffing)

- 사전적 의미는 `코를 킁킁거리다, 냄새를 맡다.`
- 공격 도구를 이용하여 `랜카드를 무차별 모드(Promiscuous Mode)로 설정한 후 연결된 회선에 흐르는 모든 IP 패킷을 가로채는 공격을 말한다.`
  - `네트워크 트래픽을 몰래 훔쳐보는 공격`을 말한다.
- 대표적인 공격 기법으로 `스위치 재밍(MAC Flooding), ARP Spoofing/Redirect, ICMP Redirect, SPAN / 포트 미러링 기능 이용, 미러링 장비 이용`등이 있다.

# 스누핑(Snooping)

- 사전적 의미는 `기웃거리다, 염탐하다.`
- 스니핑과 의미상 유사하지만, 스니핑은 몰래 엿듣는다는 의미가 강하고, `스푸핑은 몰래 정보를 획득한다는 의미가 강하다.`

# 스푸핑(Spoofing)

- 사전적인 의미는 `속이다.`
- `TCP/IP 프로토콜의 구조적 결함을 이용한 공격기법이다.
  - `포트 주소, IP 주소, MAC 주소 등을 조작하여 네트워크  트래픽 흐름을 왜곡하고 시스템 권한 탈취 등의 행위를 수행하는 공격`이다.
- 대표적인 공격기법으로 `ARP Spoofing, IP Spoofing, DNS Spoofing`등이 있다.

# 도스 / 디도스(DoS / DDoS)

- Denial of Service(서비스 거부) / Distributed DoS(분산 서비스 거부)
- `대량의 트래픽 발생 등을 통해 공격 대상 시스템이 정상적인 서비스를 할 수 없도록 만드는(서비스를 마비시키는) 형태의 공격`이다.
  - 즉, `네트워크 대역을 고갈`시키는 등의 공격을 말한다.
    - 도스 / 디도스 공격이 발생하면 공격 대상 사이트의 서비스 가용성에 심각한 영향을 미친다.

# Land Attack

- 공격자가 `패킷의 출발지 주소를 목적지 주소와 동일하게 설정하여 공격 대상 컴퓨터에 전송하는 공격`이다.
  - 즉, `출발지 IP와 목적지 IP가 동일`하다.
- 해당 공격을 당하게 되면 컴퓨터의 실행 속도가 느려지거나 동작이 마비되어 정상적인 서비스가 불가능한 상태가 된다.
  - `출발지 주소와 목적지 주소가 동일한 패킷을 차단`하여 공격에 대응할 수 있다.

# Fragment Overlap(단편 중첩 공격)

- 단편의 오프셋(offset) 값을 조작하여 `패킷 필터링 장비를 우회`하는 공격 기법이다.

공격 방식

1. 공격자는 공격용 IP 패킷을 위해 두 개의 단편(Fragment)을 생성한다. `첫 번째 단편에선 패킷 필터링 장비에서 허용하는 HTTP(TCP 80)와 같은 포트 번호를 설정`한다. 그리고 `두 번째 단편에선 offset을 조작해서 재조합될 때 첫 번째 단편의 일부분을 덮어쓰도록 한다.`
2. 대체적으로 공격자들은 `첫 번째 단편의 포트 번호가 있는 부분까지 덮어씌운다. `
3. `침입 탐지 / 차단 시스템에서는 첫 번째 단편은 허용된 포트 번호이므로 통과`시키고, `두 번째 단편은 이전에 이미 허용된 첫 번째 단편의 ID를 가진 단편이므로 역시 통과`시킨다.
4. 이 두 개의 단편들이 `목적지 서버에 도달하여 재조합되면, 첫 번째 단편의 포트 번호는 두 번째 단편의 공격자가 원하는 포트 번호로 덮어쓰게 되고, 공격자가 원하는 포트로 연결`된다.

# Tiny Fragment 공격

- Tiny(매우 작은) Fragment(단편) 공격은 최초의 단편을 아주 작게 만들어, 패킷 필터링 장비를 우회하는 공격 기법이다.
- `TCP 헤더 부분을 아주 작게 만들어서 네트워크 침입탐지시스템이나 패킷 필터링 장비를 우회하는 공격`이다.

공격 방식

1. TCP 헤더(일반적으로 20바이트)가 2개의 단편에 나눠질 정도로 작게 쪼개어 목적지 TCP 포트가 두 번째 단편에 위치하게 한다.
2. `패킷 필터링 장비나 IDS는 필터링을 결정하기 위해 포트 번호를 확인하는데, 포트 번호가 포함되지 않을 정도로 아주 작게 쪼개진 첫 번째 단편을 그냥 통과시킨다.`
3. 실제 포트 번호가 포함된 두 번째 단편은 첫 번째 단편이 허용되었으므로 통과된다.
4. 목적지 서버에서 이 단편들이 재조합되어, 공격자가 원하는 포트로 연결한다.

# Teardrop 공격

- 헤더가 조작된 일련의 IP 패킷 조각(IP Fragment)들을 전송함으로써 공격이 이뤄진다.
- 공격자가 패킷을 단편화할 때 정상적으로 하지 않고 데이터 일부가 겹치거나 일부 데이터를 포함하지 않고 다음 패킷으로 단편화하여 전송하면, `수신자는 패킷 재조합을 수행할 때 부하나 오류가 발생`하게 된다.
- 이 공격이 성공할 수 있는 이유는 IP 패킷 재조합 코드 버그에 있었으나 현재 대부분 시스템에서 Teardrop 공격을 방어하고 있다.

# Ping of Death

- `아주 크게 만들어진 ICMP 패킷을 전송`함으로써, `공격 네트워크에 도달하는 동안 아주 작은 조각(Fragment)이 되어, 공격 대상 시스템이 조각화된 패킷을 모두 처리해야 함으로써, 성능을 저하`시키는 공격이다.
  - 큰 용량의 ICMP Echo Request 패킷을 보내면, 라우터가 패킷당 보낼 수 있는 크기인 MTU(Maximun Transmission Unit)에 맞춰 패킷을 나눠 전송함으로써 CPU의 부하를 초래한다.

# Sumrf Attack

- `출발지 IP 주소를 희생자의 IP 주소로 위조한 ICMP Echo Request 패킷을 증폭 네트워크로 브로드캐스트`하여 `다수의 ICMP Echo Reply 패킷이 희생자에게 전달되어, 서비스 거부 상태를 유발`하는 공격이다.
  - 여러 호스트가 `특정 공격 대상에게 다량의 ICMP Echo Reply를 보내게 하여 서비스 거부를 유발`하는 공격이다.

## Sumrf Attack 대응법

- 중간 매개자로 쓰이는 것을 막기 위해 `다른 네트워크로부터 자신의 네트워크로 들어오는 Directed Broadcast 패킷을 막도록 라우터를 지정`한다.
- 호스트는 `IP Broadcast Address로 전송된 ICMP Echo Request 패킷에 대해 응답하지 않도록 시스템을 설정`한다.

# TCP SYN Flooding Attack

- `출발지 IP 주소를 위조한 다수의 TCP SYN 패킷을 희생자에게 전달하여, 희생자의 TCP 연결 자원을 모두 소진`시키는 형태의 서비스 거부 공격이다.

# DDOS 공격 도구

|     도구      | 날짜 | 공격방식                                              |
| :-----------: | :--: | :---------------------------------------------------- |
|    Trinoo     | 1999 | UDP                                                   |
|      TFN      | 1999 | UDP, ICMP, TCP(SYN), Smurf                            |
| Stacheldracht | 1999 | UDP, ICMP, TCP(SYN), Smurf                            |
|     TFN2K     | 2000 | UDP, ICMP, TCP(SYN), Combo                            |
|     Shaft     | 2000 | UDP, ICMP, TCP(SYN), Combo                            |
|    Mstream    | 2000 | UDP                                                   |
|    Trinity    | 2000 | UDP, Fragment, TCP(SYN, RST, Random, Flag, ACK, NULL) |

## Trinoo

- UDP Flooding DDoS 공격을 유발하는데 사용되었다.
- Attacker, Master, Zombie로 공격 네트워크를 구성한다.
- rpc.statd, rpc.cmds, rpc.ttdserverd 데몬의 취약점을 이용한다.
- 접속 포트
  - Attacker -> Master : 27665 / tcp
  - Master -> Zombie : 27444 / udp
  - Zombie -> Master : 31335 / udp
  - Zombie -> Victim : udp 공격

## TFN(Tribe Flood Network)

- rpc.statd, rpc.cmds, rpc.ttdserverd 데몬의 취약점을 이용한다.
- Attacker가 Master에 명령 시 패스워드를 사용하지 않고 ICMP Echo Request 패킷에 명령어를 전송한다.
- TCP, UDP, ICMP 등을 복합적으로 사용하여, TCP Syn Flooding, UDP Flooding, ICMP Flooding, Smurf 공격을 수행한다.

# Stacheldracht

- Trinoo와 TFN의 발전된 형태이다.
- TCP Syn Flooding, UDP Flooding, ICMP Flooding, Smurf 공격 등을 수행한다.
- Master에새로운 Agent가 자동으로 갱신되는 특징이 있다.
- 접속 포트
  - Attacker -> Master : 16660 / tcp
  - Master -> Zombie : 65000 / tcp
  - Zombie -> Master : ICMP Echo Reply
  - Zombie -> Victim : TCP Syn, UDP Flooding, ICMP Flooding, Smurf

# TFN2K

- TFN의 발전된 형태로, 통신에 특정 포트가 사용되지 않고 암호화되어 있다.
- TCP, UDP, ICMP 등을 복합적으로 사용하여 TCP Syn Flooding, UDP Flooding, ICMP Flooding, Smurf 공격 등을 수행한다.
- UDP 패킷의 헤더는 정상적인 UDP 패킷보다 3byte 더 크고, TCP 패킷의 헤더 길이는 항상 0이다.

# P2P 봇넷

- `분산형 명령 / 제어(Command / Control) 방식`이다.
- 참여 멤버(좀비 / 봇) 모두 C&C(Command & Control) 역할을 하므로, 별도의 도메인과 C&C 서버가 불필요하다.
- 대표적인 봇넷으로 Storm, Peacomm 등이 있다.

- 중앙 집중형 명령 / 제어방식의 봇넷에는 IRC 봇넷, HTTP 봇넷이 있다.

# DNS 싱크홀(SinkHole)

- 악성 봇에 감염된 PC가 해커의 명령을 받기 위해 `명령 & 제어 서버(C&C 서버)로 연결을 시도할 때 이를 싱크홀 서버로 우회시켜, 더 이상 해커로부터 조종 명령을 받지 않도록 해주는 서비스`이다.
  - 악성 봇에 감염된 PC가 `싱크홀이 적용된 DNS에 질의를 요청하면, DNS는 악성봇 PC에 싱크홀 서버 IP 주소를 반환`한다.

# C&C 서버와 통신 채널을 형성하는 과정에서 보안장비로부터 탐지 및 차단되는 것을 방지하기 위한 우회 기법

## 1. Fast Flux 기법

- 하나의 C&C 서버 도메인명에 미리 확보한 다수의 C&C 서버 IP 주소를 할당하는 기법이다.
- `IP를 여러개 할당하고, 캐시 DNS 서버에 도메인 정보가 저장되는 시간인 TTL값을 매우 작게 설정하여 IP 주소가 질의 시마다 빠르게 변경`되도록 한다.
- 보안장비에 의해 Fast Flux IP 중에 어느 하나가 탐지 및 차단된다고 해도, 다른 IP를 통해 지속적으로 C&C서버에 접속할 수 있다.

## 2. DGA(Domain Generation Algorithm) 기법

- `새로운 C&C서버 도메인을 동적으로 다수 생성하여 C&C서버가 노출되는 것을 숨기는 기법`으로, `도메인 기반으로 탐지하는 보안장비를 우회하기 위한 목적`으로 사용한다.
- 특정한 규칙에 따라 도메인명을 다수 생성하기 때문에 C&C서버를 운영하는 공격자는 특정한 규칙에 따라 생성될수 있는 도메인명 중 하나를 DNS 서버에 새롭게 등록하는 방식으로 운영한다.

## 3. Domain Shadowing 기법

- 알려진 `합법적인 도메인의 서브(하위) 도메인을 몰래 등록하여, C&C서버의 도메인으로 사용`하는 기법을 말한다.
- 적법한 절차로 도메인을 소유하고 있는 도메인 관리자의 개인정보 등을 탈취하여 `도메인 소유자 몰래 많은 서부(하위) 도메인을 등록`시키는 방식이다.
- 일반적으로 드라이브 바이 다운로드(DBD) 공격에서 악성코드 유포지에 접근하기 위한 경유지 도메인들을 수많은 서브(하위) 도메인으로 구성하여 보안장비의 탐지 및 차단을 어렵게 한다.

# HTTP GET Flooding

- `공격자가 동일한 동적 컨텐츠에 대한 HTTP GET 요청을 대량으로 발생시켜 공격 대상 웹서버가 해당 요청을 처리하기 위해 서버 자원을 과도하게 사용하도록 하여 정상적인 요청을 처리하지 못하도록 하는 서비스 거부 공격`이다.
- 이전의 네트워크 자원을 고갈시키는 방식들에 비해 훨씬 적은 개수의 패킷으로 효과적인 DDoS 공격을 수행할 수 있다.
- `좀비 PC의 IP를 변조시키지 않고, 정상적인 3-Way Handshake 후 동일한 URL에 반복 요청을 수행`하여, 웹서버의 CPU 및 연결 자원의 고갈을 유발하거나, 정상적인 3-Way Handshake 후 로그인 및 상품 조회와 같은 요청을 반복 전송하여, 웹서버 및 DB 서버의 CPU 및 연결 자원의 고갈을 유발한다.

# TCP Syn Flooding

- `출발지 IP를 위조한 다수의 연결 요청(SYN 요청)을 발생시켜, 공격 대상 서버의 제한된 연결요청대기큐(Backing Queue)를 모두 소진시키는 형태의 공격이다.`
- 정상적인 TCP 연결은 클라이언트로부터 SYN + ACK에 대한 ACK 응답을 받아 연결 설정이 완료된다.
  - 즉, SYN 요청에 대한 SYN + ACK 응답 이후 클라이언트로부터 ACK 응답이 와야한다.
- `TCP Syn Flooding 공격의 경우 공격자가 출발지 IP를 위조하여(IP 스푸핑 사용) 다수의 요청을 발생시키고, 위조된 출발지 주소이기 때문에 SYN + ACK에 대한 정상 ACK 응답이 발생하지 않는다.`
  - 즉, 서버 측에서 다수의 SYN_RECEIVED 상태(SYN_RECV)의 연결 설정 중인 소켓 상태를 확인할 수 있다.
- 일부 RST 응답이 있을 수 있는데, 이는 위조된 출발지 IP가 실제 존재하는 IP일 때 발생할 수 있다.

# Slow HTTP Header DoS(Slowloris)

- HTTP 프로토콜의 취약점을 이용한 공격이다.
- `다수의 HTTP 요청 시 요청 헤더의 끝을 의미하는 개행문자(CRLF : Carriage Return / Line Feed)를 전송하지 않고, 불필요한 헤더 정보를 천천히 지속해서 전송`하여, 대상 웹서버와의 연결을 장시간 지속함으로써 자원을 모두 소진시키는 형태의 DoS 공격이다.
  - `정상적인 HTTP 패킷의 헤더는 CRLF가 두 번 나타난다. Slowloris 공격이 발생하면 헤더의 마지막에 개행문자를 하나만 전송한다.`

# Slow HTTP POST Dos(RUDY)

- 다수의 `HTTP POST 요청 시 Content-Length 헤더를 매우 크게 조작한 후, 소량의 데이터를 천천히 지속해서 전송하여 대상 웹서버와의 연결 상태를 장시간 지속시킴`으로써, 연결 자원을 모두 소진시키는 형태의 DoS 공격이다.

# Slow HTTP Read DoS

- 다수의 `HTTP 요청에 대한 응답 시 조작된 'zero window packet'을 천천히 지속해서 전송`하여, 대상 웹서버와의 연결 상태를 장시간 지속시킴으로써 연결 자원을모두 소진시키는 형태의 DoS 공격이다.

# DNS 증폭 공격(DRDoS)

- 많은 양의 응답 레코드 정보를 발생시키는 DNS 질의 타입인 ANY, TXT타입을 주로 이용한다.
  - 즉, 요청 대비 응답이 큰 DNS 질의를 이용한다.
- ANY 타입
  - `질의한 도메인 이름과 일치하는 모든 타입의 레코드를 반환`한다.
- TXT 타입
  - `질의한 도메인에 대한 텍스트 정보(TXT 레코드 정보)를 반환`한다.

# 멤캐시드(Memcached)

- 오픈소스 메모리 캐싱 시스템으로, 11211/tcp와 11211/udp 포트를 기본 포트로 사용한다.
- 대규모 데이터 저장소의 부하를 줄이기 위한 목적으로, 통상 캐시가 필요한 시스템에서만 사용되고, 인터넷에 노출되지 않기 때문에 별도 `권한 설정을 요구하지 않는다.`
  - 별도의 인증과정 없이 접근을 허용하기 때문에 공격자가 멤캐시드 서버 IP 주소의 기본 포트인 11211번 포트로 희생자의 IP 주소로 위조한 특정 명령의 UDP 패킷을 전송하면 멤캐시드 서버가 희생자 IP로 원래 패킷보다 증폭된 패킷을 반사하게 된다

# WSD(WS-Discovery)

- 웹 서비스 디스커버리(Web Service Discovery)는 `자동으로 장비를 검색해주는 기술`이다.
  - 내부 네트워크망에서 사용되지만, 인터넷망에 노출되면 디도스 공격으로 악용될 수 있다.
- UDP 3702번 포트를 기반으로 한 멀티캐스트 통신을 사용한다.

## WSD 증폭/반사 공격

- 요청 시 악의적으로 `XML 오류 응답 메시지를 반복적으로 유발하는 명령을 요청하고, 위조된 피해자의 IP로 대규모의 증폭된 응답이 가게 만드는 공격기법`이다.
  - 최대 100배까지 증폭 공격이 가능하다.

# ARMS(Apple Remote Management Service)

- `애플 기기들의 원격제어 기능`을 활성화할 때 사용되는 데스크톱 원격제어 프로토콜이다.
- TCP / UDP 3283번 포트를 사용한다.

## ARMS 증폭/반사 공격

- `피해자의 IP로 출발지 IP를 위조한 후, 취약한 애플 Mac 컴퓨터를 대상으로 원격 접속 요청을 보내, 증폭된 응답이 가게 만드는 공격기법`이다.

# CoAP(Constrained Application Protocol)

- 불안정한 네트워크상의 `저전력 IoT 기기`들을 위한 일종의 애플리케이션 프로토콜이다.
- HTTP 형식과 유사하며, UDP 프로토콜의 5683번 포트를 사용한다.

## CoAP 증폭/반사 공격

- 피해자 IP로 스푸핑한 출발지 IP에서 외부 노출된 IoT 기기 및 모바일 장치들을 대상으로 변조된 GET Request를 보내 증폭된 응답이 가게 만드는 공격 기법이다.

# WEP(Wired Equivalent Privacy)

- `40비트의 WEP 공유 비밀키와 임의로 선택되는 24비트의 IV(Initial Vector : 초기 벡터)로 조합된 총 64비트의 키를 이용한 RC4 스트림 암호화 방식`으로 보호한다.
- 선택된 공유 비밀키의 KEY ID와 IV값을 평문으로 상대방에게 알려줘야 하므로 WEP 키가 추출될 수 있는 취약점이 존재한다.
  - 평문의 무결성을 보장하기 위해 `CRC-32 알고리즘을 이용하여 무결성 체크값(ICV: Integrity Check Value)을 생성한 후 평문과 조합하여 키스트림과 XOR 연산을 수행, 암호문을 생성`한다.
- IEEE802.11b 표준에 정의된 보안규격이다.
- `무선 AP와 무선 단말기 사이에 사전에 서로 동일하게 설정한 공유키(공유 비밀키)를 이용하여 인증과 데이터 암호화 기능을 제공`하지만, `해당 무선랜을 사용하는 모든 장비가 하나의 공유키(공유 비밀키)를 사용하므로 보안 문제가 발생할 수 있다.`

# WPA

- IEEE 802.11i 표준에 정의된 보안 규격이다.
- WEP와 동일한 RC4 알고리즘을 기반으로 한다.
- `48bit의 확장된 IV(Initial Vector)를 사용`하는 TKIP 암호화 방식을 사용한다.

# WPA2

- IEEE 802.11i 표준에 정의된 보안 규격이다.
- WPA와 키 관리의 유사성을 갖고 있지만, `AES 기반의 128bit 대칭키를 사용하고, 블록 암호모드로 CCM 모드를 사용하는 CCMP 암호화 방식을 사용`한다.

# 무선랜 보안기술 표준

|            설정방식            |   보안기술   |      인증       |       암호화        |
| :----------------------------: | :----------: | :-------------: | :-----------------: |
|  개인 모드<br>(Personal-Mode)  |     WEP      |       PSK       | RC4(64bit / 128bit) |
|  개인 모드<br>(Personal-Mode)  | WPA(or WPA1) |       PSK       |      RC4-TKIP       |
|  개인 모드<br>(Personal-Mode)  |     WPA2     |       PSK       |      AES-CCMP       |
| 기업 모드<br>(Enterprise-Mode) | WPA(or WPA1) | IEEE 802.1x/EAP |      RC4-TKIP       |
| 기업 모드<br>(Enterprise-Mode) |     WPA2     | IEEE 802.1x/EAP |      AES-CCMP       |

# 워 드라이빙(War Driving)

- 무선 네트워크를 찾기 위해 무선 장치를 갖고 주위의 AP(Access Point)를 차즌 과정을 말한다.
- 무선랜 해킹을 위한 준비 단계에서 사용되는 방법이다.

# SSID(Service Set Identifier)

- 무선랜을 구분하기 위해 32Byte 이름으로, 서로 다른 `무선랜을 식별`하기 위한 용도로 사용한다.
- 무선 장비에서 `WI-FI를 활성화했을 때 나오는 무선랜 목록이 SSID`다.

## 무선 AP 보안 설정

1. 물리적 보호를 위해 `보호 케이스 설치, AP 리셋 버튼 차단` 등을 한다.
2. `관리자 모드 접속 비밀번호를 설정`하고 주기적으로 변경하여 공격자가 AP 관리자 모드로 접속하는 것을 방지한다.
3. `SSID(Service Set Identifier)를 초기값이 아닌 새로운 값으로 변경`하여 공격자가 쉽게 인지하지 못하도록 한다.
4. `SSID를 브로드캐스트 하지 않고 숨김 모드로 설정`한다.
5. `무선 AP에서 제공하는 안전한 인증 및 암호화 방식을 적용`한다.
6. 무선 AP에 접속을 `허용할 무선 단말기 리스트들을 등록하여(MAC 필터링) 임의의 사용자 접근을 차단한다.

# NAT(Netword Address Translation)

- 내부 네트워크에서 사용하는 `사설 IP와 인터넷에서 사용하는 공인 IP간의 변환 기술`을 의미한다.
  - 즉, 보유하고 있는 `IP 주소가 부족한 경우, 사설 IP 주소를 사용하여 IP주소를 확장`하는 방법이다.
- 부족한 공인 IP(IPv4)를 절약할 수 있다.
- `외부에선 사설 IP를 사용하는 내부 호스트로 직접 접근이 불가능하므로, 내부 내트워크를 보호할 수 있는 보안상의 장점이 있다.`
- NAT을 이용하면 IP 주소 변환 장비(라우터 or 방화벽)의 인터페이스 IP로 변환된다.

# 가상 사설망(VPN : Virtual Private network)

- 인터넷과 같은 공중망을 이용하여 사설망이 요구하는 서비스를 제공할 수 있도록 구축한 망이다.
  - 즉, `공중망을 마치 전용선으로 사설망을 구축한 것처럼 사용하는 방식`이다.
  - 단일 회사만 사용하는 전용선처럼 사용하는 기술이다.
- `암호화 프로토콜을 이용한 암호화 세션을 제공`한다.
  - 가정이나 회사 외부에서 인터넷을 통해 회사의 서버에 안전하게 연결할 수 있다.
- 고비용의 전용선에 비해, `낮은 비용으로 사설망과 같은 수준의 서비스를 제공`한다.
- 구현 기술로는 터널링(Tunneling), 인증 / 암호화(Authentication / Encryption), 접근제어(Access Control) 등이 있다.

# 2계층 VPN 프로토콜

## PPTP(Point to Point Tunnel Protocol)

- MS에서 개발
- `하나의 터널에 하나의 연결만을 지원`한다.
  - 즉, 일대일 통신만 가능하다.

## L2F(Layer 2 Forwarding)

- CISCO에서 개발
- `하나의 터미널에 여러 개의 연결을 지원`한다.
  - 즉, 다자간 통신이 가능하다.

## L2TP(Layer 2 Tunneling Protocol)

- MS와 CISCO에서 공동 개발
- `L2F에 기반을 두고, PPTP와 호환성을 고려`하여 만들어진 터널링 프로토콜

# IPsec

- `3계층에서 동작하는 표준화된 터널링 프로토콜`이다.
- `IP 패킷에 대한 다양한 보안 서비스`를 제공한다.
- IPsec은 `2가지 기본 프로토콜(AH, ESP)`을 갖고 있다.
- 키 교환 프로토콜로 IKE(Internet Key Exchange) 프로토콜을 사용한다.
- IPsec은 `전송 모드(Transport Mode)와 터널 모드(Tunnel Mode) 2가지의 동작 모드`가 있다.

## AH(Authentication Header)

- 메시지 인증 코드(MAC)을 이용하여 `"비연결형 무결성(connectionless integrity)"과 "데이터 원천 인증(data origin authentication)" 서비스를 제공`하고, `기밀성은 제공하지 않는다.`
- `순서번호(sequence number)를 통해 재전송 공격을 방지`한다.
- 송신처 인증(Authentication)과 무결성(Integrity)를 보장한다.
- 프로토콜 식별번호로 51번을 사용한다.

## ESP(Encapsulating Security Payload)

- 메시지 인증 코드(MAC)를 이용하여, `"비연결형 무결성(connectionless integrity)"과 "데이터 원천 인증(data origin authentication)" 서비스를 제공`하고, `대칭키 암호화를 통해 기밀성 서비스를 제공`한다.
  - `즉, AH프로토콜은 기밀성을 제공하지 않지만, ESP 프로토콜은 기밀성까지 제공`한다.
- `순서번호(sequence number)를 통해 재전송 공격을 방지`한다.
- 송신처 인증(Authentication), 무결성(Integrity) 및 기밀성(Confidentiality)을 보장한다.
- 프로토콜 식별번호로 50번을 사용한다.

## IKE(Internet Key Exchange) 프로토콜

- `IPsec의 보안연관(SA : Security Association) 생성을 위한 협상에 사용되는 키 교환 프로토콜`이다.
- `500 / udp 포트를 사용`한다.
- 보안연관(SA)이란, `송.수신자 사이에 논리적인 연결 상태를 유지하는 동안 적용할 보안 설정 정보`이다.
  - 보안연관은 `단방향 특성이 있으므로, 송.수신을 모두 하려면 2개의 보안연관(송신용, 수신용)이 필요`하다.

## 전송 모드(Transport Mode)

- IP 패킷의 `페이로드(Payload)를 보호`하는 모드이다.
  - 즉, `IP 프로토콜의 상위 프로토콜 데이터를 보호`하는 모드이다.
- 원본 IP 헤더를 그대로 유지하기에 네트워크상 패킷 전송에 문제가 발생하지 않는다.
- 일반적으로, `종단 노드(End Node) 구간의 IP 패킷 보호를 위해 사용`한다.

## 터널 모드(Tunnel Mode)

- `IP 패킷 전체를 보호`하는 모드이다.
- `IP 패킷 전체를 IPsec으로 캡슐화하기 때문에 원본 IP 헤더를 식별할 수 없다.`
  - `네트워크상 패킷 전송이 불가능하므로 전송구간(터미널 게이트웨이 구간) 주소 정보를 담은 New IP 헤더를 추가`한다.
- 일반적으로, `양쪽 터널 게이트웨이 구간` 또는 `터널 게이트웨이 구간의 IP 패킷 보호`를 위해 사용한다.

## IPSec을 통해 제공 되는 보안서비스

|                              보안 서비스                              | 설명                                                                                                                                                             |
| :-------------------------------------------------------------------: | :--------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                      기밀성<br>(confidentiality)                      | 전달된 메시지가 도중에 도청되어도 그 내용을 알 수 없음을 보장한다.                                                                                               |
|             비연결형 무결성<br>(connectionless integrity)             | 전달된 메시지가 도중에 위변조되지 않았음을 보장한다.                                                                                                             |
|     데이터 원천 인증<br>(data origin authentication, 송신처 인증)     | 전달된 메시지가 올바른 발신지로부터 온 메시지임을 보장한다.                                                                                                      |
|           재전송 공격 방지<br>(protection against replays)            | 전달된 메시지가 재전송된 것이 아니고, 현재 발신지로부터 송신된 실제 메시지임을 보장한다.<br>`순서번호(Sequence Number)를 이용하여 재전송 공격을 방지할 수 있다.` |
|                     접근 제어<br>(access control)                     | 중요한 정보 및 시스템에 대하여 접근권한을 달리 부여하여 제어한다.                                                                                                |
| 제한적 트래픽 흐름의 기밀성<br>(limited traffic flow confidentiality) | 제한적으로 네트워크상 트래픽 흐름에 대한 정보의 기밀성을 보장한다.                                                                                               |

# 터널링(Tunneling)

- 송신자와 수신자 사이의 전송로에 외부로부터의 침이블 막기 위해 일종의 파이프를 구성하는 것이다.
  - 파이프는 터널링을 지원하는 프로토콜을 사용하여 구현하고 있으며, `사설망과 같은 보안 기능을 제공`한다.
- 터널링되는 데이터를 페이로드(Payload)라고 하며, 터널링 구간에서 터널링 프로토콜을 통해 페이로드는 캡슐화되어 전송된다.

# SSL / TLS

- 넷스케이프사가 개발했다.
- 신뢰할 수 있는 `종단-대-종단의 안전한 서비스를 제공`하기 위해 `TCP를 이용`하도록 설계하였으며, `인증 및 암호화 기능`을 제공한다.
- `웹 브라우저와 웹서버 간 서로 상대의 신원을 확인하는 기능`이 있다.
- 네트워크상 통신 보안을 제공하기 위해 설계된 암호 규격 표준이다.
  - `전송 계층 종단 간 데이터 기밀성과 무결성을 제공`한다.

## SSL(Secure Socket Layer) / TLS(Transport Layer Security)

- 응용(Application) 계층과 전송(Transport) 계층(TCP) 사이에 위치하여 기밀성, 무결성, 인증과 보안 서비스를 제공하는 프로토콜이다.
  - 전송 계층에서 동작한다.
- 웹 브라우저는 서버와 교환하는 `데이터의 암호화에 사용되는 대칭키 생성 정보 교환을 위해, 서버 인증서에 포함된 공개키를 이용하여 해당 정보를 암호화한 후 서버로 전달`한다.
- 웹 브라우저와 서버 간에 전달되는 `데이터의 무결성 점검을 위해, MAC(Message Authentication Code)함수를 이용하여, 데이터의 변경 여부를 점검`한다.
- `443/tcp 포트를 사용`한다.

## TLS(Transport Layer Security)

- 인터넷기술표준화기구(IETF)에서 SSL을 기반으로 표준화했다.
  - 즉, TLS는 SSL의 향상된 더욱, 안전한 버전이다.
- 무선 환경에서는 WTLS(Wireless TLS)가 사용된다.
- TLS 1.2 이하 버전
  - 최초 세션 연결 시 (완전 협상), 2-RTT(Round Trip Time)를 거쳐야 한다.
  - 세션 재연결 시 (단축 협상), 1-RTT(Round Trip Time)를 거쳐야 한다.
- TLS 1.3
  - 최초 세션 연결 시 (완전 협상), 1-RTT(Round Tript Time)를 거쳐야 한다.
  - 세션 재연결 시 (단축 협상), 0-RTT를 지원한다.
    - 0-RTT는 공유된 암호키를 로컬에 저장하여, 바로 요청 메시지에 해당 키를 사용하는 방식이다.

## SSL/TLS을 구성하는 서브 프로토콜

- `상위 계층의 Handshake 프로토콜, Change Cipher spec 프로토콜, Alert 프로토콜, Application Data 프로토콜`과 `하위 계층의 Record 프로토콜`로 구성된다.

|          프로토콜           | 설명                                                                                                                                                                                                     |
| :-------------------------: | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|     Handshake 프로토콜      | 종단 간 보안 파라미터(Security Parameter)를 협상하기 위한 프로토콜 <br>즉, `세션 정보와 연결 정보에 사용할 보안 파라미터를 협상하기 위한 프로토콜`이다.                                                  |
| Change Cipher spec 프로토콜 | 협상한 보안 파라미터를 이후부터 적용(변경)함을 알리기 위한 프로토콜 <br>즉, `서버와 클라이언트 상호 간에 협상한 암호명세(ciper spec) 확인 및 적용(변경)함을 알리기 위한 메시지를 교환하는 프로토콜`이다. |
|       Alert 프로토콜        | 통신 과정에서 발생하는 오류(암호화 오류, 인증서 오류 등)를 통보하기 위한 프로토콜                                                                                                                        |
|  Application Data 프로토콜  | 응용(Application) 계층의 데이터를 전달하기 위한 프로토콜                                                                                                                                                 |
|       Record 프로토콜       | `단편화 및 재조립, 암호화 및 복호화, 압축 및 압축해제, 메시지 인증 코드(MAC) 생성 및 검증 등의 기능`을 제공하는 프로토콜                                                                                 |

### Handshake 프로토콜 수행 절차

1. 초기 보안 파라미터(프로토콜 버전, 키 교환 및 인증 알고리즘, 암호명서(cipher spec) 등) 협상
2. 서버 인증 및 키 교환
3. 클라이언트 인증 및 키 교환
4. 협상한 보안 파라미터를 적용하여 메시지 교환

### Recode 프로토콜

- 메시지를 암호화하여 통신을 수행하는 프로토콜이다.
- 상위 계층의 메시지를 `단편화(Fragmentation), 압축(Compression), MAC(Message Authentication Code) 생성, 암호화(Encrtption)과 같은 처리과정을 거쳐 헤더를 붙인 후 하위 계층의 프로토콜로 전송`한다.

# DTLS(Datagram Transport Layer Security)

- 전송 계층(Transport Layer)에서 UDP 기반(데이터그램 기반) 클라이언트 / 서버 응용 프로그램 간에 보안 서비스를 제공하는 통신 프로토콜이다.
- 도청, 변조(간섭), 위조 등을 방지하기 위해 설계되었다.
- TLS 프로토콜에 바탕을 두고 있으며, 동등한 안전성을 보장한다.

# BEAST Attack(Browser Exploit Against SSL / TLS)

- 사용자 브라우저의 취약점을 이용하여 HTTPS 쿠키를 훔쳐, HTTPS 세션을 가로챌 수 있는 공격이다.

# CRIME Attack(Compression Ration Info-Leak Mass Exploitation)

- HTTPS의 압축에 따른 취약점을 이용하여 HTTPS 쿠키를 훔쳐 HTTPS 세션을 가로챌 수 있는 공격이다.

# SSH(Secure Shell)

- 암호통신을 이용해서 네트워크상의 다른 컴퓨터에 접속하여, 원격으로 명령을 실행하거나, 파일을 조작하는 응용 프로그램 or 프로토콜을 의미한다.
- 인터넷에서 `원격으로 호스트를 관리`하는 안전한 암호통신 터미널 프로그램이다.
  - `Telnet과 FTP의 취약점을 보완하여 암호화 통신`을 수행한다.
    - 관리자가 FTP 혹은 Telnet을 사용하면, 평문(Plaintext) 형태의 통신이 이뤄져 스니핑(Sniffing) 공격에 노출된다.
- 한 컴퓨터에서 다른 컴퓨터로 파일을 옮긴다.
- rlogin, rsh, telnet, ftp와 같은 프로그램을 안전하게 대체한다.
- TCP 22번 포트를 사용한다.
- `암호화된 원격 터미널 서비스 제공(Telnet 기능 대체)`
- `암호화된 파일 송수신 서비스 제공(FTP 기능 대체)`
